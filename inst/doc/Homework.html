<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yingsi Liang" />

<meta name="date" content="2024-12-05" />

<title>Homework of ‘Statistical Computing’ course</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of ‘Statistical Computing’
course</h1>
<h4 class="author">Yingsi Liang</h4>
<h4 class="date">2024-12-05</h4>



<div id="homework1---09-18" class="section level1">
<h1>Homework1 - 09-18</h1>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<ul>
<li>generate random samples from a Rayleigh<span class="math inline">\(f(x) = \frac{x}{\sigma^2}
e^{-\frac{x^2}{2\sigma^2}}, \quad x \geq 0, \sigma&gt;0\)</span>.</li>
<li>use the histogram to check the model.</li>
</ul>
</div>
<div id="solution" class="section level3">
<h3>Solution</h3>
<ul>
<li>Calcutate the PDF of Rayleigh distribution.</li>
<li>Use the inverse TransformMethod.</li>
</ul>
<p>First, the PDF of Rayleigh distribution is:</p>
<p><span class="math display">\[ F(x; \sigma) = \int_0^x
\frac{t}{\sigma^2} e^{-\frac{t^2}{2\sigma^2}} \, dt \]</span></p>
<p>Use another variable<span class="math inline">\(u =
\frac{t^2}{2\sigma^2}\)</span>, so we have <span class="math inline">\(du = \frac{t}{\sigma^2} \, dt\)</span></p>
<p>And then</p>
<p><span class="math display">\[ F(x; \sigma) =
\int_0^{\frac{x^2}{2\sigma^2}} e^{-u} \, du
                = \left[ -e^{-u} \right]_0^{\frac{x^2}{2\sigma^2}}
                = 1 - e^{-\frac{x^2}{2\sigma^2}}
\]</span></p>
<p>So the PDF of Rayleigh distribution is <span class="math inline">\(F(x; \sigma) = 1 - e^{-\frac{x^2}{2\sigma^2}}
\quad \text{for } x \geq 0\)</span></p>
<p>Second, according to the inverse TransformMethod, we need to do as
follow:</p>
<p>Generate <span class="math inline">\(U \sim
\mathcal{U}(0,1)\)</span></p>
<p>Return <span class="math inline">\(X =
F_{x}^{-1}(U)=\sigma\sqrt{-2log(1-U)}=
\sigma\sqrt{-2log(U)}\)</span></p>
<p>This situation is <span class="math inline">\(\sigma=1\)</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">88</span>) </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成 n 个 [0, 1) 之间的均匀随机数</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>rayleigh_n <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u))  <span class="co"># Rayleigh 变换</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">hist</span>(rayleigh_n, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Rayleigh Distribution &quot;</span>,sigma<span class="sc">==</span><span class="dv">1</span>)), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,  <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># 绘制原本的图像</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>yy <span class="ot">&lt;-</span> (y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">lines</span>(y,yy)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This situation is <span class="math inline">\(\sigma=2\)</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">88</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成 n 个 [0, 1) 之间的均匀随机数</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>rayleigh_n <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u))  <span class="co"># Rayleigh 变换</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">hist</span>(rayleigh_n, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Rayleigh Distribution &quot;</span>,sigma<span class="sc">==</span><span class="dv">2</span>)), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,  <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># 绘制原本的图像</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>yy <span class="ot">&lt;-</span> (y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">lines</span>(y,yy)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmZmZmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQZmaQkGaQtpCQ29uQ2/+t2Oa2ZgC2Zjq2kGa2tra2ttu229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/9vb////tmb/25D/27b/29v//7b//9v////H5+6nAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATJ0lEQVR4nO2de2PbthXFj/Owu25LFjfb2rVe94iVdUsbtV2XWk5sff9PNYIvURIhESCAiwue3x8yZV5cXAJHAPgCsCVkBpAOgOgG0gEQ3UA6AKIbSAdAdAPpAIhuIB0A0Q2kAyC6gXQARDeQDoDoBtIBEN1AOgCiG0gHQHQD6QCIbiAdANENpAMguoF0AEQ3kA6A6AbSARDdQDoAohtIB0B0A+kAiG4gHQDRDaQDILqBdABEN5AOgOgG0gEQ3UA6AKIbSAdAdAPpAIhuIB0A0Q2kAwjEBg1Pv7wb3f948/xu8tfO29OXH0Z2ftpLtXryfiS7T8fJnPj4R+DipX/6dEA6gEB0AgIuR/d7CaiqxDdHO3/8zfthqlEBGZs5Arq/qnN/NqbNzIB0AIHY4Jv6789Xps6POV2dxwKqvX16i2N5HChmVEDjzdJkHm/wddUK3eDVHC9pgHQAgegEtNvYx0tAlRKO6zCBgB6uLwd/8gbSAQTiQEA/fV51P9VwqPlW1UQjkY/fNv9uFfPxddVN/P3qlfn66w0uvjryZuqwtn18W/Uqv31nGoeql3y8uVzjyX+aLuyHt/We1mfjqrZpcqzSvWj2/vf1IIsJUEAJ2e/C1s0I5lVbB9XOujrbocVlW9ntVxgBPXvdbO17q+2aoU47JOoE9PQKlVBqAf2pHSyNCajN4sn7RnmDLGqNG+wt44ZdWDp2g+iX5qf7pPrN3193Y9zqo1XBH0xbUqmjEYb5+vNVLSA8f7f9sR+A7/rBNumD8bX9ydToqlHDq24QjSf/ND4vdwK6a23qvS/vur24vKuUfXkYsFVA91czTuOSAekAAtGfxn/dfP/fd3/73NSNkULXD91f1bVX9T/Dr5taQKbdalTS/O9IQBcvvvvQ/aeyN7psJFIP2s0/RgTUemz2miR9FpXDKtJNd9FhdXwOeW85HcgMSAcQiLrKP960Y4y256gqy4hn0zY5XZeFpltqVXLfjIHuhkPp4y6s7hTr4VPfuuydxq9N73YkIOP7eG+Xq9lxaWtk1nj2Lk5RhQXSAQSiqfKma6lUg99/+e9f6l/7+sn7XXW2AmpaiykCMq1U8+9fvm0lGUZAfeaj54x1n6qg/9qWJiDTM7zZ9udepg7ur/5y3Y6au+rcbo+7MIuAVm3jVX/59PPryvuhgAZdWN9JjXZhBy1QG++rNp+9LuxRxSWgGkgHEIiuyjfNwKfqGapz9KbKnpq6avqii6/MULhtVfYG0aMC+vTWuGjF9qHuIt/UihkKyHQ19TC5vmjUNB29zXAQvZ/Fqt4YaHrIavxiVo5AOoBA7F36q7qw7uzZDCb6AW/bh3W1OzyNPxTQ4a2MVd9ArPtrPI+D03iTR53q2etmxHQ5luMgi6pxeleJfPRuxaCvTVF2s4B0AIEYXPqrastcIXz6ddO7ND3V7kJid1mvu5D4j9ExUHNK9+Vdl/TxX1ftKd7D6/YKUCegHyqnL+qEP17hRb1rZ1NfujT3ZA+zMO2S7X5pr18KKAMs9zZ6LL0ImQakA4jNR+tNsIdrc6L88bWKyy3ZAukA4mJGQ9YGZjeuId5AOoC4VCdFL+07+3EN8QbSARDdQDoAohtIB0B0A+kAiG4gHQDRDaQDILqBdABEN5AOgOgG0gEQ3UA6AKIbSAdAdAPpAIhuIB0A0Q2kAyC6gXQARDeQDoDoBtIBEN1AOgCiG0gHQHQD6QCIbiAdANENpAMguoF0AEQ3kA6A6AbSARDdQDoAohtIB0B0A480ton9yAKBg2038ZeSqY9ICuBi3E6dzhaI9MDJupv4lAIiLXC0N/MOUkCkB64J1nhFAZEeOKcwc9BSQKQF7kkebygg0gHpAIhu4JdszetApAZhvPQEcUf0gKzdkexB1u5I9sDJuls51joCcnNH9AMX43W3bIB1PWEnd6QA4GD7eNPLZm1ZwcTFHSkBONg+XPcXEDeWTszFHSkBONiyBSJHwMV43d3D4BiItMDJunsm0boktZs7oh9k7Y5kD7J2R7IHWbsj2YOs3ZHsQdbuSPYga3cke5C1O5I9yNodyR5k7Y5kD7J2R7IHWbsj2YOs3ZHsQdbuSPYga3cke5C1O5I9yNodyR5k7Y5kD7J2R7IHWbsj2YOs3ZHsQdbuSPYga3cke5C1O5I9yNodyR5k7Y5kD7J2R7IHWbsj2YOs3ZHsgXuSDXDxJpw7oho4Wa+AV/e/uxtONTXHnTs4QeSsyShwMV49v6uX65GbYAq3VmJnTUaBg23d7tx/ZgQkNcUdBZQbcLB9uDbzkj1+2LIFIh1wMe5XyGikNNedBxRQbsDJet2cfm2s6z25uXOHAsoNZO3u2D8FlBnI2t2xf5t6eCYvBPyS2dYL83Q3mWMBNcppWyDKKDkI4yXV1TwcqWekC6OIEoKs3R37t6jncAxEDaUCWbs79j/suU4PoimhJMDJWny9MPT6mXIWRg3FBy7G8uuFwSYfy2k8FRQbONhmsFoPbPKxXgeihOICB9sM1guDVT/2C4mUUEzgYJtFC2TTzy1OETmsBQMX41TrhZ2SgkU+lYDseziajgecrBOtF2bVwgn9nBQQ+7FoIEd31l7qhErOCIgKigRydGc5zcIplZwTECUUB+ToblQLzR3TGQKigmKAHN2NXifEaZVMEBDfOooAcnQ3ooV2+DxTQGyEgoMc3Y099XNOJdMExEYoNMjR3ZEWcLThLSAqKCzI0d2hFhBSQOzGgoIc3R09dzhBJdMFRAWFBDm629fC8PJzEAFRQQFBju4OBDRJJS4CooLCgRzd7T/rPE0lTgLiUDoY6DYerm132L3czfNi1UUwAbERCgR2m2tgtoZw1mKSF6ss/ATEB4Xigb1vszWEsxaTvAzqPoSAbLri+9DzwcH39al3LtzdeXqx1n1IARkFhYl3yWD4ZVOp55vt4431eTE3d97YX94JKqBbdmHzQb9lnjZslGN7Yt7J3RxgrfmwArqlgGaDbuPh2jr1qo+7eV6sFR9YQFTQbNBtPHzR6GdG87MNK6DRp4JCC4gXhGaCbqMTkG3iFkd3s2ieHUsjIF4QmgeaP6vdlZFcTuPHn2sNLyAqaBboNroWKJC7eV6stR5DQOzF5oAc3dlfYI4iICpoBsjRnf39nTgCooL8Qf35cP2qe+l0znXocAKyv1oYRUBUkDfI0Z39FfhYAqKCfEGO7uyvwEcTEBXkCfots3zB+sS8CYZ1fbNsG3uaXz8tzBMQFeQH+q3V87v7q8vt6tJubFY6eLg2BgUKiNeDvEC3YaYfM2tgnLiV0UwwVd+sjykgv0mA5guICvIB3YYR0KqSxYlbGd0Ud1VbFVVAQi0QFeQD+q3V5cP187umhxqnn+JudRlRQJDqwrZUkAfotx6ucfHm8ebEEKhvnSrTMgVEBTkDJ+tuksTHm2gCMh7kBMRzMVeQmbu6CRAUEBXkCPqts8sYuLmb40BSQFSQG+i3Vi7KiTWIbtKLCogKcgLdhnUd3UleQr2o16SXFRAV5AK6jcE6BiHczUouLCCeizmAbuP0Cbyzu1nJpQVEBU0H/ZZ9Le8dkdcL61KLC4gKmgy6jSkPlMVeL6xLnVBAXsw6yMKAg23s1Xr6xAkF5JVozkGWBhxsI68XtkubhYBO7JpxkMWB3WbViT2/W504mY/bAg2SZiGgE3My+B9keaDf2ly8WZu78ScUFHW9sEHSPARkf7Lf/yDLA92GaV7WJx4Vq4m4XtgwZSYCsr5b5H2QBYJuwwxwjICkJlcYpsxFQJaBkP9BFgi6ja4FWvnPLrWdIaC9hNkIyGGB8aWCfqsZA60nXE6c5G5OwnwEND7HzJwSKg3sNusBzsxZpnDWYkq6jAQ0ZuF7kEWCPNztp8tJQCMmvgdZJJBzd+JeQSQt+CU6sglcZrpBt9Gcoc8aQW8dBWStx7wEdGTkcpDFg/bvqn1leeZc9ThrMbC111A0LfglOtT3rCIqDDR/Nt3g+f4q2VmYHgEdmLkcZPGg/hw8TXbq3fip7ibaWmsxOwHtXw9yOcjiQf05uAOWbpZWTQLaX/VuRgEVB+rPCQ9quLibaGutxAwFtLfu5owCKg7UnxTQ+T2DlX9nFFBxoP6UFNDYpd7IWvBL1CvI5SCLB/WnoIBGbzbF1oJfok5BLgdZPKg/+yfqU77arE5AnYJcDrJ4IOcO1hrMVUCtggKXmW4g506hgBoFBS4z3UDOHezVlEILnolAAe0BOXc6BXTLhVb3gJw7WGspawFxlcM9IOdOq4DYAg2BnDufJVXyEFDgQlMN5NzpFRCnoNoBOXc+S6pkIiAqqAdy7jQLiArqgJw71QLiFFQtkHPndQodWgteiZrwAxedUiDnTrmAqKAaiLnzevsrJwFRQQY42E546MPBnX4BcSi9dSwC6xorHu6gvgtzLr4igZP12cmkJ7uD/jGQR/kVCNzMz00mPdkdChHQ4gdCkHFn7MoQ0NIbIci4M3alCGjZCoKIu9qsGAEtuhuDX7KZ64XVZuUIaMkKQhgvjstI1GYFCWjBCoKEu8ZKr4C4DMsOSLhrrPQKyPrfwKWpAThZh1kvrDUqTEDmnTG30iwCuBgHWi+sNSpNQLeLfFgaDraBVuvpbMoT0BIVBAfbQOuFdTZFCsilPIsADrZsgc4mWt5labgYB1kvrDcpU0BLuyQEJ+sQ64X1JoUKaGEKQmp3O4tSBbQsCSG1u51FuQJakoKQ2N3AoEQBLe8uB9K6G+4vUUCDzQOrwAWdDUjrbri/bAEdSihwQWcD0rob7i9dQMtYYANJ3e3tLl5At0tYHwFJ3e3tXoCAbsuf3h4p3e3vXYSAbkufnRwp3e3vXYiACp+dHAndHexcioAaCQUu6GxAQncHO5cjoNuCn/NAQncHO5ckoNtinzVDZHenLu7nUK3pEhV6gwyR3cFeuksTUJn3WBHZHeyFuzwB1Q1y2AIXB5HdUUDdrq5ACpMQIruDvWyXKaDSJITI7iigbtewUAqSECK7o4C6XYU+aobI7mAv2oUJ6OgfZSwCjcjuKKATu1DAEqyI7A4nii9+DWWfiF3YOXewlx4F1O5RLSFEdkcBnU+01dwMIbI7Cuh8ItXnZ4jsDvbCo4D29xzfYA5cOVFAZHcUkFOifQ0FrpwowMnafYo72MuOAhrfs2uJ3CpHBrgYe0xxRwF5JWpE5FQ5QsDB1meCKQrIP5GKcTQcbH2muIO9gCigs3u23SOdTnWaFDjYerZAFJBvor40Mz6rh4uxxxR3ONFCBy3sEhMdlmaOl4fgZO0+xR0FNCPRiUuM2SgJkd0Ffvcih2pNKKAT7trSFRdT4HyP3FFAMxKdcudF2Moer/FpTF4vjAKakWieuzTS8k+5LxNbIH6/FJIa/6r3Vw0hFBCZCZysz95MJUsDLsbnb6aSpQEH2wm3MsjSgIPthJupZGnAwZYtEDkCLsbnb6Ye+ycqcBLNXgU7WZ+9mTrT/xwKzClZRjNy8k+Zh/+ic0qWEQVUZk7JMqKAyswpWUYUUJk5JcuIAiozp2QZUUBl5pQsIwqozJySZUQBlZlTsowyFhApHEgHQHQD6QCIbiAdANENpAMguoF0AEQ3kA6A6AbSARDdQDoAohtIB0B0A+kAiG4gHQDRDaQDILpBTOcb4OJNzAw66nf2k71tvUryUtz9FXCZIB/zthbwzXmzcRAwkEM2lXo2KRT0eFPlsk5U3NXPIoWANlUmD9cpDmltqslbQQgZyj7Ni6yrBGVwf2UO3zZrWmAerlMIqCm8FIf0eGNqyLuaEDCUA5JW63abprEzb3X/NYGA7j9LcjDbrAVUl0G6aRhWSXKqjirFGGjz5PvrRMO6bLuwpkVI1C6kmrPIdC0pBLQ2k3g1jUN0Zp3rIGAgB6QV0CbNGNpMS5JEQBfJmm/Tct9f+f76EDKUfZJ2YYnmTKuPKYmA6mJrhpFxmTlURchY9kk5iF4nugq0bmdDiV6vze8uxVB6ZkeBkLHsk+40fjdxURJStEDNbHApmu/md+6dE0LGckCyC4n+PbgXSa5Em8HWYEq4iGQ7Bqob/CRD6LZjSXW+l+ZWxibZ3ZnVnJwQMBCyQCAdANENpAMguoF0AEQ3kA6A6AbSARDdQDoAohtIB0B0A+kAiG4gHQDRDaQDILqBdABEN5AOgOgG0gEQ3UA6AKIbSAdAdAPpAIhuIB0A0Q2kAyC6gXQARDeQDoDoBtIBEN1AOgCiG0gHQHQD6QCIbiAdANENpAMguoF0AEQ3kA6A6AbSARDdQDoAZZgJ1x6uk05HlDeQDkAZZs6ndZL5gZQA6QC0sXny/Rep5gDXAKQDUMcq1ZocOoB0AOrwn9S9SCAdgDYeb/6cbPEGDUA6AG2sn/+aZO5ULUA6AGWY+ZvTrR+jAEgHoIxVPX0zh9E9kA6A6AbSARDdQDoAohtIB0B0A+kAiG4gHQDRDaQDILqBdABEN5AOgOgG0gEQ3UA6AKIbSAdAdAPpAIhuIB0A0Q2kAyC6gXQARDeQDoDoBtIBEN1AOgCiG0gHQHQD6QCIbiAdANENpAMguoF0AEQ3/weGGZk2ZPdXaQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>This situation is <span class="math inline">\(\sigma=3\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">88</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成 n 个 [0, 1) 之间的均匀随机数</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>rayleigh_n <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u))  <span class="co"># Rayleigh 变换</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">hist</span>(rayleigh_n, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Rayleigh Distribution &quot;</span>,sigma<span class="sc">==</span><span class="dv">3</span>)), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,  <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># 绘制原本的图像</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="fl">0.01</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>yy <span class="ot">&lt;-</span> (y<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">lines</span>(y,yy)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-3.11" class="section level2">
<h2>Exercise 3.11</h2>
<div id="question-1" class="section level3">
<h3>Question</h3>
<ul>
<li>Generate a random sample of size 1000 from a normal location
mixture.</li>
<li>The components of the mixture have <span class="math inline">\(\mathcal{N}(0,1)\)</span> and <span class="math inline">\(\mathcal{N}(3,1)\)</span> distributions with
mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>.</li>
</ul>
</div>
<div id="solution-1" class="section level3">
<h3>Solution</h3>
<p>Now <span class="math inline">\(S=p_1F_{X_{1}}+p_2F_{X_{1}}\)</span>,
where <span class="math inline">\(X_1 \sim \mathcal{N}(0,1)\)</span> and
<span class="math inline">\(X_2 \sim \mathcal{N}(0,1)\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(u<span class="sc">&gt;</span><span class="fl">0.25</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> k<span class="sc">*</span>x1<span class="sc">+</span>k<span class="sc">*</span>x2</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Use different <span class="math inline">\(p_1\)</span></p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>We can find that when the values of <span class="math inline">\(p_1\)</span> is higher, it is easier to observe
the mixture appears to be bimodal. So we try to control the <span class="math inline">\(p_1\)</span> between 0 and 1.</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The result is if the values of <span class="math inline">\(p_1\)</span> is higer than <span class="math inline">\(0.5\)</span>, it will produce bimodal
mixtures.</p>
</div>
</div>
<div id="exerise-3.20" class="section level2">
<h2>Exerise 3.20</h2>
<div id="question-2" class="section level3">
<h3>Question</h3>
<ul>
<li>Simulate a compound Poisson<span class="math inline">\((\lambda)\)</span>-Gamma process.</li>
<li>Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for different choices of the
parameters and compare with the theoretical values.</li>
</ul>
</div>
<div id="solution-2" class="section level3">
<h3>Solution</h3>
<p>First, calculate the mean and variance of compound Possion-Gamma
process.</p>
<p><strong>Mean Calculation</strong></p>
<p>Expected Value of Poisson Process is: <span class="math inline">\(E[N(t)] = \lambda t\)</span></p>
<p>So</p>
<p><span class="math display">\[
E[X(t)] = E\left[\sum_{i=1}^{N(t)} Y_i\right] = E[N(t)] \cdot E[Y_i] =
(\lambda t) E[Y_i]
\]</span></p>
<p><strong>Variance Calculation</strong></p>
<p>Law of total variance is: <span class="math inline">\(Var(X(t)) =
E[Var(X(t) | N(t))] + Var(E[X(t) | N(t)])\)</span></p>
<p>and <span class="math inline">\(E[Var(X(t) | N(t))] = E[N(t)] \cdot
E(Y_1) = (\lambda t) \cdot E(Y_1)\)</span></p>
<p>and <span class="math inline">\(Var(E[X(t) | N(t)]) = Var(N(t) \cdot
E(Y_1)) = (E(Y_1))^2 \cdot Var(N(t)) = (\lambda t) \cdot
E(Y_1)\)</span></p>
<p>So</p>
<p><span class="math display">\[
Var(X(t)) = (\lambda t) (E[Y_1])^2
\]</span></p>
<p>this situation is <span class="math inline">\(\lambda=1\)</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span>          <span class="co"># Poisson 过程的平均事件数</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span>           <span class="co"># Gamma 分布的形状参数</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>            <span class="co"># Gamma 分布的尺度参数</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">10</span>              <span class="co"># 模拟时间长度</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t) {</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="co"># 生成 Poisson 随机变量 N</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> T)  <span class="co"># 在时间区间 T 内生成的事件数量</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  <span class="co"># 生成 Gamma 随机变量并求和</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  gamma_samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> alpha, <span class="at">scale =</span> beta)  <span class="co"># 生成 N 个 Gamma 样本</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  total_amount <span class="ot">&lt;-</span> <span class="fu">sum</span>(gamma_samples)  <span class="co"># 计算总和</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="fu">return</span>(total_amount)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  </span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co"># 进行多次模拟</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, <span class="fu">simulate_compound_poisson_gamma</span>(lambda, alpha, beta, t))</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co"># 计算均值和方差</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>mean_X <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>var_X <span class="ot">&lt;-</span> <span class="fu">var</span>(results)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;X(10) 的均值:&quot;</span>, mean_X, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## X(10) 的均值: 19.99885</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;X(10) 的方差:&quot;</span>, var_X, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## X(10) 的方差: 60.20827</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;均值理论值为：&quot;</span>,lambda<span class="sc">*</span>T<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;真实值与理论值的差距为：&quot;</span>,<span class="fu">abs</span>(lambda<span class="sc">*</span>T<span class="sc">*</span>alpha<span class="sc">*</span>beta<span class="sc">-</span>mean_X),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 均值理论值为： 20 真实值与理论值的差距为： 0.001152613</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差理论值为：&quot;</span>,lambda<span class="sc">*</span>T<span class="sc">*</span>(alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">*</span>beta)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;真实值与理论值的差距为：&quot;</span>,<span class="fu">abs</span>(lambda<span class="sc">*</span>T<span class="sc">*</span>(alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">*</span>beta)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>var_X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差理论值为： 60 真实值与理论值的差距为： 0.2082653</code></pre>
<p>this situation is <span class="math inline">\(\lambda=5\)</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">5</span>          <span class="co"># Poisson 过程的平均事件数</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span>           <span class="co"># Gamma 分布的形状参数</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>            <span class="co"># Gamma 分布的尺度参数</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">10</span>              <span class="co"># 模拟时间长度</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t) {</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="co"># 生成 Poisson 随机变量 N</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> T)  <span class="co"># 在时间区间 T 内生成的事件数量</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  <span class="co"># 生成 Gamma 随机变量并求和</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  gamma_samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> alpha, <span class="at">scale =</span> beta)  <span class="co"># 生成 N 个 Gamma 样本</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>  total_amount <span class="ot">&lt;-</span> <span class="fu">sum</span>(gamma_samples)  <span class="co"># 计算总和</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>  <span class="fu">return</span>(total_amount)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>}</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>  </span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co"># 进行多次模拟</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, <span class="fu">simulate_compound_poisson_gamma</span>(lambda, alpha, beta, t))</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co"># 计算均值和方差</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>mean_X <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>var_X <span class="ot">&lt;-</span> <span class="fu">var</span>(results)</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;X(10) 的均值:&quot;</span>, mean_X, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## X(10) 的均值: 99.9689</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;X(10) 的方差:&quot;</span>, var_X, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## X(10) 的方差: 307.1442</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;均值理论值为：&quot;</span>,lambda<span class="sc">*</span>T<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;真实值与理论值的差距为：&quot;</span>,<span class="fu">abs</span>(lambda<span class="sc">*</span>T<span class="sc">*</span>alpha<span class="sc">*</span>beta<span class="sc">-</span>mean_X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 均值理论值为： 100 真实值与理论值的差距为： 0.03110191</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差理论值为：&quot;</span>,lambda<span class="sc">*</span>T<span class="sc">*</span>(alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">*</span>beta)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;真实值与理论值的差距为：&quot;</span>,<span class="fu">abs</span>(lambda<span class="sc">*</span>T<span class="sc">*</span>(alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">*</span>beta)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>var_X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差理论值为： 300 真实值与理论值的差距为： 7.144236</code></pre>
<p>this situation is <span class="math inline">\(\lambda=10\)</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">10</span>          <span class="co"># Poisson 过程的平均事件数</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span>           <span class="co"># Gamma 分布的形状参数</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>            <span class="co"># Gamma 分布的尺度参数</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">10</span>              <span class="co"># 模拟时间长度</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t) {</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>  <span class="co"># 生成 Poisson 随机变量 N</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> T)  <span class="co"># 在时间区间 T 内生成的事件数量</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="co"># 生成 Gamma 随机变量并求和</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  gamma_samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> alpha, <span class="at">scale =</span> beta)  <span class="co"># 生成 N 个 Gamma 样本</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  total_amount <span class="ot">&lt;-</span> <span class="fu">sum</span>(gamma_samples)  <span class="co"># 计算总和</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="fu">return</span>(total_amount)</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>}</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  </span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co"># 进行多次模拟</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, <span class="fu">simulate_compound_poisson_gamma</span>(lambda, alpha, beta, t))</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co"># 计算均值和方差</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>mean_X <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>var_X <span class="ot">&lt;-</span> <span class="fu">var</span>(results)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;X(10) 的均值:&quot;</span>, mean_X, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## X(10) 的均值: 199.8951</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;X(10) 的方差:&quot;</span>, var_X, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## X(10) 的方差: 607.744</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;均值理论值为：&quot;</span>,lambda<span class="sc">*</span>T<span class="sc">*</span>alpha<span class="sc">*</span>beta,<span class="st">&quot;真实值与理论值的差距为：&quot;</span>,<span class="fu">abs</span>(lambda<span class="sc">*</span>T<span class="sc">*</span>alpha<span class="sc">*</span>beta<span class="sc">-</span>mean_X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 均值理论值为： 200 真实值与理论值的差距为： 0.1049156</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差理论值为：&quot;</span>,lambda<span class="sc">*</span>T<span class="sc">*</span>(alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">*</span>beta)<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;真实值与理论值的差距为：&quot;</span>,<span class="fu">abs</span>(lambda<span class="sc">*</span>T<span class="sc">*</span>(alpha<span class="sc">*</span>beta<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(alpha<span class="sc">*</span>beta)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>var_X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差理论值为： 600 真实值与理论值的差距为： 7.743966</code></pre>
</div>
</div>
</div>
<div id="homework2---09-26" class="section level1">
<h1>Homework2 - 09-26</h1>
<div id="exercise-5.4" class="section level2">
<h2>Exercise 5.4</h2>
<div id="question-3" class="section level3">
<h3>Question</h3>
<ul>
<li>计算<span class="math inline">\(Beta(3,3)\)</span>密度函数的蒙特卡洛估计值。</li>
<li>估计分布函数，其中<span class="math inline">\(x=0.1,0.2,...,0.9\)</span>，并与R中的内置函数进行比较。</li>
</ul>
</div>
<div id="solution-3" class="section level3">
<h3>Solution</h3>
<p>贝塔分布的密度函数为：</p>
<p><span class="math display">\[
f(x; \alpha, \beta) = \frac{x^{\alpha-1} (1 - x)^{\beta-1}}{B(\alpha,
\beta)}, \quad 0 &lt; x &lt; 1, \quad
B(\alpha, \beta) = \int_0^1 t^{\alpha-1} (1 - t)^{\beta-1} \, dt
\]</span> 如果取<span class="math inline">\(\alpha=3,\beta=3\)</span>，则密度函数为：</p>
<p><span class="math display">\[
f(x; 3, 3) = \frac{x^{2} (1 - x)^{2}}{B(3, 3)}=30 \cdot x^{2} (1 -
x)^{2}, \quad 0 &lt; x &lt; 1
\]</span> 令<span class="math inline">\(y =
\frac{t}{x}\)</span>，得到<span class="math inline">\(dt =
xdy\)</span>,则分布函数为： <span class="math display">\[
\theta = F(x;3,3)= \int_0^x 30 \cdot t^{2} (1 - t)^{2} dt = \int_0^1 30
\cdot x^{3}y^{2} (1 - xy)^{2} dy
\]</span> 因此<span class="math inline">\(\theta = E_Y[30 \cdot
x^{3}Y^{2} (1 - xY)^{2}]\)</span>，其中随机变量<span class="math inline">\(Y \sim
U(0,1)\)</span>，可以通过生成独立同分布的服从均匀分布的随机数，然后计算分布函数。</p>
<p>生成简单蒙特卡洛估计CDF的函数为：</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)  <span class="co"># 固定随机数种子</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 蒙特卡罗模拟次数</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co"># Beta分布的概率密度函数</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>beta_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">mean</span>(<span class="dv">30</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x <span class="sc">*</span> y)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>}</span></code></pre></div>
<p>利用上述函数估计分布函数，并与内置函数<span class="math inline">\(pbata\)</span>比较为：</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">10</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>cdf_beta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(t))</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="co"># 估计CDF</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  cdf_beta[i] <span class="ot">&lt;-</span> <span class="fu">beta_cdf</span>(x[i])</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>}</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co"># 标准</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>Phi <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(x, cdf_beta, Phi), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##           [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10]
## x        0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900 1.000
## cdf_beta 0.009 0.058 0.163 0.318 0.501 0.685 0.841 0.948 0.999 1.008
## Phi      0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991 1.000</code></pre>
</div>
</div>
<div id="exercise-5.9" class="section level2">
<h2>Exercise 5.9</h2>
<div id="question-4" class="section level3">
<h3>Question</h3>
<ul>
<li>利用对偶变量的方法生成瑞利分布的样本。</li>
<li>对比利用对偶变量下方差的减小值。</li>
</ul>
</div>
<div id="solution-4" class="section level3">
<h3>Solution</h3>
<p>瑞利分布的密度函数为： <span class="math display">\[ F(x; \sigma) =
\frac{t}{\sigma^2} e^{-\frac{t^2}{2\sigma^2}} \, dt \quad x \geq
0,\sigma &gt;0\]</span> 计算瑞利分布的分布函数为： <span class="math display">\[ F(x; \sigma) =\int_0^x \frac{t}{\sigma^2}
e^{-\frac{t^2}{2\sigma^2}} \, dt
                = \int_0^{\frac{x^2}{2\sigma^2}} e^{-u} \, du
                = \left[ -e^{-u} \right]_0^{\frac{x^2}{2\sigma^2}}
                = 1 - e^{-\frac{x^2}{2\sigma^2}}
\]</span> 利用简单蒙特卡洛积分法和对偶变量法模拟瑞利分布：</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 固定随机数种子</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 蒙特卡罗模拟次数</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co"># 模拟函数 Rayleigh分布的概率密度函数</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>Rayleigh_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma, <span class="at">antithetic =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>) <span class="cf">else</span> v<span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> u)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  cdf_ray <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>    cdf_ray[i] <span class="ot">&lt;-</span> (<span class="fu">mean</span>((x[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> u <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x[i]<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>  }</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>  cdf_ray</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>}</span></code></pre></div>
<p>与标准的瑞利分布进行比较:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># 标准的瑞利分布</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="at">length=</span><span class="dv">20</span>)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>Phi_ray <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>cdf_ray1<span class="ot">&lt;-</span> <span class="fu">Rayleigh_cdf</span>(x,sigma,<span class="at">antithetic=</span><span class="cn">FALSE</span>)</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>cdf_ray2<span class="ot">&lt;-</span> <span class="fu">Rayleigh_cdf</span>(x,sigma)</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(x, cdf_ray1, cdf_ray2, Phi_ray), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##            [,1]  [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]   [,9]  [,10]
## x        0.1000 0.200 0.3000 0.4000 0.5000 0.6000 0.7000 0.8000 0.9000 1.0000
## cdf_ray1 0.0012 0.005 0.0111 0.0197 0.0306 0.0438 0.0591 0.0765 0.0959 0.1170
## cdf_ray2 0.0012 0.005 0.0112 0.0198 0.0308 0.0440 0.0594 0.0769 0.0963 0.1175
## Phi_ray  0.0012 0.005 0.0112 0.0198 0.0308 0.0440 0.0594 0.0769 0.0963 0.1175
##           [,11]  [,12]  [,13]  [,14]  [,15]  [,16]  [,17]  [,18]  [,19]  [,20]
## x        1.1000 1.2000 1.3000 1.4000 1.5000 1.6000 1.7000 1.8000 1.9000 2.0000
## cdf_ray1 0.1398 0.1641 0.1897 0.2165 0.2443 0.2730 0.3023 0.3321 0.3623 0.3926
## cdf_ray2 0.1404 0.1648 0.1905 0.2174 0.2452 0.2740 0.3033 0.3332 0.3634 0.3937
## Phi_ray  0.1404 0.1647 0.1904 0.2173 0.2452 0.2739 0.3032 0.3330 0.3632 0.3935</code></pre>
<p>计算方差：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>MC1[i] <span class="ot">&lt;-</span> <span class="fu">Rayleigh_cdf</span>(x, sigma, <span class="at">anti =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>MC2[i] <span class="ot">&lt;-</span> <span class="fu">Rayleigh_cdf</span>(x, sigma)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.002062559</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(MC2))</span></code></pre></div>
<pre><code>## [1] 0.0001445471</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">print</span>((<span class="fu">var</span>(MC1) <span class="sc">-</span> <span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1))</span></code></pre></div>
<pre><code>## [1] 0.9950886</code></pre>
</div>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<div id="question-5" class="section level3">
<h3>Question</h3>
<ul>
<li>选择两个重要性函数，需要接近函数<span class="math inline">\(g(x)=\frac{x^2} {\sqrt{2 \pi}} e^{-x^2 /2} ,\quad
x&gt;1\)</span>。</li>
<li>比较两个重要性函数的模拟结果。</li>
</ul>
</div>
<div id="solution-5" class="section level3">
<h3>Solution</h3>
<p>选择的重要性函数为： <span class="math display">\[
f_1(x) = \left\{ \begin{array}{ll}
e^{-x} &amp; \text{当 } x&gt;1 \\
0 &amp; \text{其他}
\end{array}
\right.
\]</span> <span class="math display">\[
f_2(x) = \left\{ \begin{array}{ll}
\frac{1}{\sqrt{2\pi}} e^{-\frac{(x-1)^2}{2}} &amp; \text{当 } x&gt;1 \\
0 &amp; \text{其他}
\end{array}
\right.
\]</span></p>
<p>进行模拟：</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#模拟次数</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co"># 原函数</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">log</span>((x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>}</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a><span class="co"># 重要性函数1</span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(m, <span class="dv">1</span>) <span class="co">#生成指数分布的随机数</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x1 <span class="sc">&lt;</span> <span class="dv">1</span>))</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>x1[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>fg1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x1) <span class="sc">/</span> <span class="fu">exp</span>(<span class="sc">-</span>x1)</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg1)</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a><span class="co"># 重要性函数2</span></span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">1</span>,<span class="dv">1</span>) <span class="co">#生成正态分布的随机数</span></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which</span>(x2 <span class="sc">&lt;</span> <span class="dv">1</span>))</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>x2[i] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>fg2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x2) <span class="sc">/</span> <span class="fu">dnorm</span>(x2,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg2)</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg2)</span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a></span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.3992855 0.3939711
## se        0.5849535 0.4052930</code></pre>
<p>对比可知，重要性函数<span class="math inline">\(f_2(x)\)</span>更好，因为他有更小的方差。</p>
<p>后面进一步绘制图像发现，重要性函数<span class="math inline">\(f_2(x)\)</span>更加贴近原本函数。</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>kk<span class="ot">&lt;-</span><span class="fu">g</span>(k)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">plot</span>(k,kk)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">plot</span>(k,<span class="fu">exp</span>(<span class="sc">-</span>k)<span class="sc">*</span>(k<span class="sc">&gt;</span><span class="dv">1</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAbFBMVEUAAAAAADoAAGYAOpAAZpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmAGZmOpBmZjpmtttmtv+QOgCQOmaQZgCQkNuQtpCQ2/+2ZgC2tv+2///bkDrb2//b////tmb/25D//7b//9v///8DlQgPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL90lEQVR4nO3d6XbjxhVFYbQV2XHEdpJmEps2LYrk+79jCIAaWmaBqDr3AjXs74fjrJUAFLRVKIzszoCgW/sDoGwEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJMYBdajEWgHZLg5rISBICAgSAoKk7oAi5nhIU3VA3VIraljNAXXDCERBrqoOqHv9B9xUHdB4vnKBNTWs6oC6jhHIW+UBRZ1sR4KaA+pn0RzJO6s7IHZi7qoO6Nwxj/ZWe0AMQc7qDoghyF3lAV3PRROQmwYC4lDeU+0BjYfyDEFu6g+IIchV9QH182gC8tNCQMOh2GLra0wLAXEk76iFgIZDeQLyUX9ADEGuGgiIk4meGgmII3kvLQTEfUGO2giIi/Jumgjo9WQiBdlrJSCGICeeAR267stvdotTcCTvxSmgXdc9vfzj+XzcfLNYnIzjMC8+Ae0ens+7YfTZX/5NXpyO09FeXAIaxp2Xn/qADj/8IS/OAqejnTgF9HT55+nPczYjENNoLz67sP3ruDOmpC7OAkOQD6dJ9H48/Dp0gTn0ClemxkkQARlr4zzQsEZ2Yh7aCYidmAvvgPaZHIWduSjvY+ERKP4F54au9wVRkKWGdmGcj/ZAQJA4BXTajr+rwAxotYC4s8ya04nE7nr+8NDlciJxXCtjkDWXgE7bt2xyuZRxXStnE635XUwd5XIx9XW13Zmr8qbaGoHeLmhQkBWvOdB1CMpsDsQsyJzTUdhxM/6eAuPPii874GyirYSADtc/4tCFdtv1mmMIMhUb0GVoeRz/7bQNn+UxXK85AjIVGdDxl4/NfP/ffNZrjrOJppq6lHFdNWOQoUYDYgiy0mBAPOhsqcWAeErMUOwkevN+S5hwDJZBQJyPthE7Ap22Ujfx63XBTsxM9C7stH1cdL0+OB9tJX4OFH7Wy2W9TjiUN9LkJPpMQGbaDYjz0SZaDYhDeSNNB8ShvK7ZgDiUt9FuQFxUNdFwQNwfbSEpoH3w5av263U0xkNAkpSAjl//JZ+NzuK3xgtfdCkBHR6PX9UhKItfGncG6RICOm2/nXeBp3Xs1+uKebQs5amMH/4IPnBqv15fFKSKD2h47PTDs6fO6/XVsRcTJVyNH99ALw5BufzGOs4nalo+DzRgJ6ZpPiBOJ2oIiDeQSwiIs0ESAmIeLYkP6Pi/8T9P/yn2sZ5POibS6RICGr+A51Dwc2GfEVC6lDPR3dOHt7zctu+u7w/K6KsOJlBQsqSLqXcfS+3v9zhu+sTKCIhj+WRJk+jgmw+vxgsdp+3Dc0EBcSSWJO0o7M7Dha+v+d09PBcSEHdIp3J5ucLbpdbdYzkBMQ1K4nMe6DWbS2+FBMR1+UROJxJfXxQdfJlHfr+n1/ct5PfJsha7Cyv/JZtBFJQidgQq/zW/YVzTSJB0InE06y0vpUyiB5wNirfwxdQu76Md5tHRuBr/EUdi0QjoI47lozkFlOd3pt7HkVgspxOJmX5n6n0ciUVyCSjjbyy8K+9Zfn6iA5rzUHO+35k6AwFFiQ7o8Ldt8GsIX5U8AlFQnPir8XPeDZTvd6bOwE4shssIlPN3ps7wdjCf84fMhcscyHK9a3g7FMv6U+aBE4m3MAbNRkA3cUJxLgK6jYJmIqAATknPQ0AhXFidxfuGMnm962EMmoNbWsM4ozgDN9VPYC92H3OgKRyL3cX7gaZ0zIPu4f1AkzJ/CCADTu8HslvvyijoDp/3Axmud20dM+lJLu8Hslzv+phJT3F5P5DlejNAQRNc3g9kud4McCw2gfNAMzAPCksLSP62p7ICuo5BFHQDAc3zVlBpH9wbAc3EfdK3EdBcnFK8iYBmo6BbOAqbj4Ju4H6gCO+H80V+fBfckRjj/ZRimZ/fAfdER+nYjX3CHCgOBX1CQJE6EvpOSkDDFdUZr+gwWW9+KOijlDnQ8Iag/Zz3BBmsN0MU9EF8QKft25eBLbHeHLEbe5dwU/3XcegJvf3QeL1ZoqA36SNQ6O2HxuvNFAldJZ0H6gvaN3ke6B0FjVKeC3vfcoG92Iz/SQUbnYJ6PueBgl9UmLa4TDEInZNGoN9n/K9P2zvPHVaxxTsSStqFjbPn6Wfj7z34U8n2pqC0i6nf+kl0w4fx75ovKGUONH6Xk3ZPYjVb+9pOswklTaL7gsRHUyva1m0PQikB7bvu39uZV1OL+tLdRE3PpZPOA/V7r7T3A1W6oRtOKCGgf45DTwtvKJvtu5lQZT/bNG4oM9LqZDrxhrKH5+lv7Sn1S3cF3ffW/jhLSbuhbP/wfH1V4m3lfumuosn9WMrtHE/DrRyh46tz6V95ma7FQSjlKOzbkMXEDWVFf+mupL2E0kegiVtaWx2Beq0llDwHmryhrOgv3RW9pdNGQsmP9Uw/lFH0l+6qupZGIc4DuWgnIQLy0cwoREBePidU6U9MQH6aSIiAPP0lofp+bALyVX1BBOSt8lGIgPxVnRABLeGvCVUTEQEto9qECGgxdTZEQAu6lVDpG4KAFnUzoaK3BQEtrbKGCGh5txMqNCICWkc1DRHQWioZhwhoRaGGSto4BLSuYEOlbCACWl24oRI2EgHlYKKh3DcUAWViqqGcKyKgjExHlOcmI6C83Gkov4oIKD93I8pp4xFQnu5HlElGBJSvORGtnhEB5W1eRCtmRED5mxvRKh0RUCkiMloyJAIqSlRFi4REQOWJrcg1JQIqVVJG9i05BdTge6LXkZ6RUUw+AbX5nujVqBUpPbkE1PJbWtdkF9L8olwCavc90XlwCCmYFCNQxZYoyGsO1O57onPkWJDTUVjT74nOWiEBRS/O4Oe6/8PiE4NtmklAttUEf1pMStmi3gHN+9Jdv34oSDBney48AgU+BwEVK49dGAEVK4+AmAMVK5eLqfRTKC6mQsKlDEi4mAoJIxAkq11MRSVcArp/MVVc/ooLLeaDZvbTe+9zGtiENSyUgLJcZjkLJaAsl1nOQgkoy2WWs1ACynKZ5SyUgLJcZjkLJaAsl1nOQgkoy2WWs9B8A0LlCAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBIXAM6dN2X3+wX+/L30KP5iYZH/gMPKqXb+/z05938Z2JmGR+1eUz8f3sGdLhsv4P9Njxugu92SHPaXj7kPnkTBvTv4HL46S9/lcYBvfykfEjHgMYHWXfGv5d+WDMO6OXH/nnJ0EvXEh03T/0msP7p+/HCOKDQY+rzOAbk8nvpH4rVfuLggh1GC4eA9g//NQ5oL31Gz4CGodHht+0T0M5hqXvzKC8b1XoOtPtZmQE6BjT+STv8YbsEFHzcX1mk+TL7aYFxQMdNv7xd6icloOsyrefQg9PWendzWZ71CDRI3qbswsZF2o8/43Jt/3yGTeoS0DhhTVDcJPrsEdDeqZ/038tt++u7V0wXOkg+li/vMN4hoL3Hb2RIx2NvazwCiR+0wBOJ5r+Vlx89xp/+9/zhnW62CzZdXv8nnuMk2u1kvnVA1x2D9UfduexrHOZA0gflYiokBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQHGGd2fiHQHFIaBPCCgOAX1CQHGGgNxeaFYgAorTB2T/8t6CEVCcS0AeL8QrFwHFOW5+Zv/1EQHFOW6+/Cp9OUltCChOPwdyeVFzqQgoTh+Q8cufy0ZAcYbDeI/vZSkVAcUZAjpuPL5Yo0wEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkBAQJAUFCQJAQECT/B36EL7OLmrDTAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>kkk<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(k<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(k<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">plot</span>(k,kkk)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<div id="question-6" class="section level3">
<h3>Question</h3>
<ul>
<li>实现快速排序法</li>
<li>在不同的数量级下测试快速排序法的时间</li>
<li>数量级与运行时间的回归</li>
</ul>
</div>
<div id="solution-6" class="section level3">
<h3>Solution</h3>
<p>首先，实现快速排序法，并输出运行时间。</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="dv">2</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">6</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">8</span><span class="sc">*</span><span class="fl">1e4</span>)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>}</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>time <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n[i]))</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  sort_result <span class="ot">=</span> <span class="fu">quick_sort</span>(test)</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  time[i]<span class="ot">=</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>}</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a><span class="co"># system.time(quick_sort(sample(1:(2*1e4))))[1]</span></span></code></pre></div>
<p>接下来，重复模拟100次并计算平均时间<span class="math inline">\(a_n\)</span>。</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># m是模拟次数</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="co"># time_vc存储每一次模拟的时间，是一个1*m的向量</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="co"># time_mean存储平均时间，是一个1*5的向量</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>time_vc <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>time_mean <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>    test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n[i]))</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>    time_vc[j] <span class="ot">=</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>  }</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>  time_mean[i] <span class="ot">=</span> <span class="fu">mean</span>(time_vc)</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>}</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="fu">print</span>(time_mean)</span></code></pre></div>
<p>最后，对<span class="math inline">\(a_n\)</span>和<span class="math inline">\(t_n=nlog(n)\)</span>进行回归。</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>nn <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>time_mean_ <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(nn))</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(nn)){</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>    test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(nn[i]))</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>    time_vc[j] <span class="ot">=</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  }</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>  time_mean_[i] <span class="ot">=</span> <span class="fu">mean</span>(time_vc)</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>}</span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="fu">print</span>(time_mean_)</span></code></pre></div>
<p>绘制示意图</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># 运行时间太长了这里记录运行结果</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>nn <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>time_mean_ <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.0000</span>,<span class="fl">0.0085</span>,<span class="fl">0.0122</span>,<span class="fl">0.0260</span>,<span class="fl">0.0320</span>,<span class="fl">0.0404</span>,<span class="fl">0.0431</span>,<span class="fl">0.0467</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(time_mean_ <span class="sc">~</span> nn) </span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="fu">plot</span>(nn,time_mean_,<span class="at">main =</span> <span class="st">&quot;散点图及回归线&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;nlog(n)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;平均运行时间&quot;</span>,<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># 使用回归模型绘制回归线</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework3---09-30" class="section level1">
<h1>Homework3 - 09-30</h1>
<div id="exercise-6.6" class="section level2">
<h2>Exercise 6.6</h2>
<div id="question-7" class="section level3">
<h3>Question</h3>
<ul>
<li>利用蒙特卡洛估计正态性下的样本偏度的0.025、0.05、0.95、0.975的分位数。</li>
<li>计算估计值的标准误。</li>
<li>估计值与大样本近似下的分位数进行比较。</li>
</ul>
</div>
<div id="solution-7" class="section level3">
<h3>Solution</h3>
<p>计算大样本近似下的分位数，分别取<span class="math inline">\(n=50,100,500\)</span>，将结果存储在矩阵<code>cv</code>里。</p>
<p>计算样本偏度系数<span class="math inline">\(\sqrt{b_1}\)</span>的分位数，并计算估计值的方差。其中，方差的计算公式如下：
<span class="math display">\[
Var(\hat{x_q})=\frac{q(1-q)}{nf(x_q)^2}
\]</span> 其中，<span class="math inline">\(f\)</span>是采样分布的密度，<span class="math inline">\(x_q\)</span>是分位数。</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mu,sigma){<span class="fu">rnorm</span>(n,mu,sigma)}</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>calculate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(sample.x){</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample.x)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample.x)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  SK <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span><span class="fu">sum</span>((sample.x<span class="sc">-</span>mu)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">return</span>(SK)</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>}</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>show_data <span class="ot">&lt;-</span> <span class="cf">function</span>(SK.li, q.li, m, n){</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  hat.SK.q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(SK.li,q.li)</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>  sd.Sk.q <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(q.li<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q.li)<span class="sc">/</span>m<span class="sc">/</span><span class="fu">dnorm</span>(hat.SK.q)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>  SK.q_large <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qnorm</span>(q.li)</span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">data.frame</span>(<span class="st">&#39;large.sample&#39;</span><span class="ot">=</span>SK.q_large,<span class="st">&#39;estimate&#39;</span><span class="ot">=</span>hat.SK.q,<span class="st">&#39;estimate.sd&#39;</span><span class="ot">=</span>sd.Sk.q))</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>}</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>hat.SK <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a>q.li <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a>  sample.j <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n,mu,sigma)</span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a>  hat.SK[j] <span class="ot">&lt;-</span> <span class="fu">calculate_data</span>(sample.j)</span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a>}</span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a><span class="fu">show_data</span>(hat.SK,q.li,m,n)</span></code></pre></div>
<pre><code>##       large.sample    estimate estimate.sd
## 2.5%   -0.02147033 -0.02073337  0.01237815
## 5%     -0.01801847 -0.01704425  0.01727825
## 95%     0.01801847  0.01789058  0.01727851
## 97.5%   0.02147033  0.02019603  0.01237801</code></pre>
</div>
</div>
<div id="exercise-6.b" class="section level2">
<h2>Exercise 6.B</h2>
<div id="question-8" class="section level3">
<h3>Question</h3>
<ul>
<li>计算皮尔逊相关系数、斯皮尔曼秩相关系数、肯德尔相关系数，并作用于二元正态分布上。</li>
<li>找到非参数检验更有效的二元分布</li>
</ul>
</div>
<div id="solution-8" class="section level3">
<h3>Solution</h3>
<p>皮尔逊相关系数用于度量两个变量之间的线性关系。相关系数的取值范围为<span class="math inline">\([-1, 1]\)</span>，其中 1 表示完全正相关，-1
表示完全负相关，0 表示无线性关系。</p>
<p>斯皮尔曼秩相关系数用于度量两个变量之间的单调关系，而不仅限于线性关系。适用于非线性关系的情况。</p>
<p>肯德尔相关系数用于度量两个变量之间的一致性。它与斯皮尔曼秩相关系数类似，但计算方法不同，基于成对数据的顺序一致性进行计算。</p>
<p>首先，生成二元正态分布随机数，并实现三种相关性度量的方法。</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>}</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>calculate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(sample.x,sample.y){</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sample.x</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> sample.y</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;pearson&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;kendall&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)<span class="sc">$</span>p.value</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p1=</span>p1,<span class="at">p2=</span>p2,<span class="at">p3=</span>p3))</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>}</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>show_data <span class="ot">&lt;-</span> <span class="cf">function</span>(p1.li,p2.li,p3.li, alpha){</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(p1.li<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(p2.li<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(p3.li<span class="sc">&lt;=</span>alpha))</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>}</span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">5e4</span></span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a>  sample.j <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n)</span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>  x <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>x</span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a>  y <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>y</span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>  p.j <span class="ot">&lt;-</span> <span class="fu">calculate_data</span>(x,y)</span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a>  p1[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p1</span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>  p2[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p2</span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>  p3[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p3</span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a>}</span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a><span class="fu">show_data</span>(p1,p2,p3,alpha)</span></code></pre></div>
<pre><code>## [1] 0.05052 0.04730 0.04962</code></pre>
<p>容易看出，此时，⽪尔逊相关系数检验的结果0.05008最接近于0.05。</p>
<p>对于非正态假设、包含离群值、样本量较小、数据非线性的情况下，非参数检验的效果更好，具体见下例：</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>y<span class="sc">^</span>{<span class="fl">0.5</span>} <span class="sc">+</span> <span class="fu">rt</span>(n,<span class="dv">2</span>)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a> }</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="fl">5e3</span></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a> alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a> p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a> <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>    sample.j <span class="ot">&lt;-</span> <span class="fu">get_data</span>(n)</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>    x <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>x</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> sample.j<span class="sc">$</span>y</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>    p.j <span class="ot">&lt;-</span> <span class="fu">calculate_data</span>(x,y)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>    p1[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p1</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>    p2[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p2</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>    p3[j] <span class="ot">&lt;-</span> p.j<span class="sc">$</span>p3</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a> }</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a> <span class="fu">show_data</span>(p1,p2,p3,alpha)</span></code></pre></div>
<pre><code>## [1] 0.7466 0.9914 0.9902</code></pre>
<p>两种⾮参数检验的功效⼤概为0.98，均⼤于⽪尔逊相关系数检验的功效0.75。</p>
</div>
</div>
<div id="exercise-3" class="section level2">
<h2>Exercise 3</h2>
<div id="question-9" class="section level3">
<h3>Question</h3>
<ul>
<li>判断两种方法的功效是否存在显著性差异
<ul>
<li>假设检验是什么样的</li>
<li>应该使用什么检验</li>
</ul></li>
</ul>
</div>
<div id="solution-9" class="section level3">
<h3>Solution</h3>
<p>设两个功效用<span class="math inline">\(p_1,p_2\)</span>表示，则假设检验为：</p>
<p><span class="math display">\[
H_0:p_1=p_2,\quad H_1:p_1 \neq p_2
\]</span></p>
<p>功效实际上是第一类错误的比例，因此可以利用<span class="math inline">\(Z\)</span>检验<span class="math inline">\(Z-test\)</span>，即为：</p>
<p><span class="math display">\[
Z=\frac{(p_1-p_2)}{\sqrt{P(1-P)(\frac{1}{n_1}+\frac{1}{n_2})}}
\]</span></p>
<p>其中，<span class="math inline">\(p_1,p_2\)</span>为第一、二种方法的功效，<span class="math inline">\(n_1,n_2\)</span>为实验次数，<span class="math inline">\(P=\frac{x_1+x_2}{n_1+n_2}\)</span>，<span class="math inline">\(x_2,x_2\)</span>是成功的数量。下面进行计算：</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>x.bar <span class="ot">&lt;-</span> <span class="fl">0.651</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>y.bar <span class="ot">&lt;-</span> <span class="fl">0.676</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fl">0.6635</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>z <span class="ot">&lt;-</span> (x.bar<span class="sc">-</span>y.bar)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>p.hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p.hat)<span class="sc">/</span>n)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">min</span>(<span class="fu">pnorm</span>(z),<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(z))</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.0001831369</code></pre>
<p>计算得到<span class="math inline">\(p=
0.000183&lt;0.05\)</span>，拒绝原假设说明两种方法有明显的差距。</p>
</div>
</div>
</div>
<div id="homework4---10-16" class="section level1">
<h1>Homework4 - 10-16</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise</h2>
<div id="question-10" class="section level3">
<h3>Question</h3>
<ul>
<li>利用Bonferroni和B-H方法调整p值。</li>
<li>在10000次模拟和<span class="math inline">\(\alpha=0.1\)</span>下计算FWER、FDP、TPR</li>
</ul>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<p>实现方法：</p>
<ul>
<li>按照题目要求生成服从均匀分布和beta分布的p值</li>
<li>利用内置函数进行p值的调整</li>
<li>计算误差值，并对结果可视化</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机数种子，保证结果可重复</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>       </span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="co"># 总假设数</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>n_null <span class="ot">&lt;-</span> <span class="dv">950</span>   <span class="co"># 原假设数</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>n_alt <span class="ot">&lt;-</span> <span class="dv">50</span>     </span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>      </span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>    </span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a><span class="co"># 初始化结果矩阵</span></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a><span class="co"># 备择假设数</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a><span class="co"># 模拟次数</span></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a><span class="co"># 显著性水平</span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni校正&quot;</span>, <span class="st">&quot;B-H校正&quot;</span>)</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a> </span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a> <span class="co"># 加载必要的库</span></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a> <span class="co"># 初始化存储变量</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>fwer_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>fdr_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a>tpr_bonf <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a>fwer_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a>fdr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>tpr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a> <span class="co"># 执行模拟</span></span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb58-29"><a href="#cb58-29" tabindex="-1"></a>  <span class="co"># 生成 p 值</span></span>
<span id="cb58-30"><a href="#cb58-30" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_null)               <span class="co"># 原假设的 p 值</span></span>
<span id="cb58-31"><a href="#cb58-31" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_alt, <span class="fl">0.1</span>, <span class="dv">1</span>)         <span class="co"># 备择假设的 p 值</span></span>
<span id="cb58-32"><a href="#cb58-32" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)          <span class="co"># 合并所有 p 值</span></span>
<span id="cb58-33"><a href="#cb58-33" tabindex="-1"></a>  true_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n_null), <span class="fu">rep</span>(<span class="dv">1</span>, n_alt))  <span class="co"># 标签：0-原假设，1-备择假设</span></span>
<span id="cb58-34"><a href="#cb58-34" tabindex="-1"></a>  </span>
<span id="cb58-35"><a href="#cb58-35" tabindex="-1"></a>  <span class="co"># Bonferroni 校正</span></span>
<span id="cb58-36"><a href="#cb58-36" tabindex="-1"></a>  p_bonf <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb58-37"><a href="#cb58-37" tabindex="-1"></a>  rejected_bonf <span class="ot">&lt;-</span> <span class="fu">which</span>(p_bonf <span class="sc">&lt;</span> alpha)</span>
<span id="cb58-38"><a href="#cb58-38" tabindex="-1"></a>  </span>
<span id="cb58-39"><a href="#cb58-39" tabindex="-1"></a>  V_bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(true_labels[rejected_bonf] <span class="sc">==</span> <span class="dv">0</span>)  <span class="co"># 误拒的原假设数</span></span>
<span id="cb58-40"><a href="#cb58-40" tabindex="-1"></a>  S_bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(true_labels[rejected_bonf] <span class="sc">==</span> <span class="dv">1</span>)  <span class="co"># 正确拒绝的备择假设数</span></span>
<span id="cb58-41"><a href="#cb58-41" tabindex="-1"></a>  R_bonf <span class="ot">&lt;-</span> <span class="fu">length</span>(rejected_bonf)                 <span class="co"># 总共拒绝的假设数</span></span>
<span id="cb58-42"><a href="#cb58-42" tabindex="-1"></a>  </span>
<span id="cb58-43"><a href="#cb58-43" tabindex="-1"></a>  fwer_bonf[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(V_bonf <span class="sc">&gt;</span> <span class="dv">0</span>)          <span class="co"># 至少一个假阳性</span></span>
<span id="cb58-44"><a href="#cb58-44" tabindex="-1"></a>  fdr_bonf[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(R_bonf <span class="sc">&gt;</span> <span class="dv">0</span>, V_bonf <span class="sc">/</span> R_bonf, <span class="dv">0</span>)  <span class="co"># 错误发现率</span></span>
<span id="cb58-45"><a href="#cb58-45" tabindex="-1"></a>  tpr_bonf[i] <span class="ot">&lt;-</span> S_bonf <span class="sc">/</span> n_alt                   <span class="co"># 真阳性率</span></span>
<span id="cb58-46"><a href="#cb58-46" tabindex="-1"></a>  </span>
<span id="cb58-47"><a href="#cb58-47" tabindex="-1"></a>  <span class="co"># B-H 校正</span></span>
<span id="cb58-48"><a href="#cb58-48" tabindex="-1"></a>  p_bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb58-49"><a href="#cb58-49" tabindex="-1"></a>  rejected_bh <span class="ot">&lt;-</span> <span class="fu">which</span>(p_bh <span class="sc">&lt;</span> alpha)</span>
<span id="cb58-50"><a href="#cb58-50" tabindex="-1"></a>  </span>
<span id="cb58-51"><a href="#cb58-51" tabindex="-1"></a>  V_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(true_labels[rejected_bh] <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-52"><a href="#cb58-52" tabindex="-1"></a>  S_bh <span class="ot">&lt;-</span> <span class="fu">sum</span>(true_labels[rejected_bh] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb58-53"><a href="#cb58-53" tabindex="-1"></a>  R_bh <span class="ot">&lt;-</span> <span class="fu">length</span>(rejected_bh)</span>
<span id="cb58-54"><a href="#cb58-54" tabindex="-1"></a>  </span>
<span id="cb58-55"><a href="#cb58-55" tabindex="-1"></a>  fwer_bh[i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(V_bh <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb58-56"><a href="#cb58-56" tabindex="-1"></a>  fdr_bh[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(R_bh <span class="sc">&gt;</span> <span class="dv">0</span>, V_bh <span class="sc">/</span> R_bh, <span class="dv">0</span>)</span>
<span id="cb58-57"><a href="#cb58-57" tabindex="-1"></a>  tpr_bh[i] <span class="ot">&lt;-</span> S_bh <span class="sc">/</span> n_alt</span>
<span id="cb58-58"><a href="#cb58-58" tabindex="-1"></a>  </span>
<span id="cb58-59"><a href="#cb58-59" tabindex="-1"></a>  <span class="co"># 可视化 p 值分布（密度图）</span></span>
<span id="cb58-60"><a href="#cb58-60" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) { <span class="co"># 只绘制第一次模拟的 p 值分布</span></span>
<span id="cb58-61"><a href="#cb58-61" tabindex="-1"></a>    <span class="co"># 创建一个数据框，用于 ggplot2 绘图</span></span>
<span id="cb58-62"><a href="#cb58-62" tabindex="-1"></a>    p_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-63"><a href="#cb58-63" tabindex="-1"></a>      <span class="at">p_value =</span> p_values,</span>
<span id="cb58-64"><a href="#cb58-64" tabindex="-1"></a>      <span class="at">hypothesis =</span> <span class="fu">factor</span>(true_labels, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Null Hypothesis&quot;</span>, <span class="st">&quot;Alternative Hypothesis&quot;</span>))</span>
<span id="cb58-65"><a href="#cb58-65" tabindex="-1"></a>    )</span>
<span id="cb58-66"><a href="#cb58-66" tabindex="-1"></a>    </span>
<span id="cb58-67"><a href="#cb58-67" tabindex="-1"></a>    <span class="co"># 绘制密度图</span></span>
<span id="cb58-68"><a href="#cb58-68" tabindex="-1"></a>    p_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(p_data, <span class="fu">aes</span>(<span class="at">x =</span> p_value, <span class="at">fill =</span> hypothesis, <span class="at">color =</span> hypothesis)) <span class="sc">+</span></span>
<span id="cb58-69"><a href="#cb58-69" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span>  <span class="co"># 绘制密度曲线</span></span>
<span id="cb58-70"><a href="#cb58-70" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> alpha, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># 显著性水平线</span></span>
<span id="cb58-71"><a href="#cb58-71" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;P-value Density for Null and Alternative Hypotheses&quot;</span>,</span>
<span id="cb58-72"><a href="#cb58-72" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">&quot;P-value&quot;</span>,</span>
<span id="cb58-73"><a href="#cb58-73" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-74"><a href="#cb58-74" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb58-75"><a href="#cb58-75" tabindex="-1"></a>    </span>
<span id="cb58-76"><a href="#cb58-76" tabindex="-1"></a>    <span class="co"># 打印图形</span></span>
<span id="cb58-77"><a href="#cb58-77" tabindex="-1"></a>    <span class="fu">print</span>(p_plot)</span>
<span id="cb58-78"><a href="#cb58-78" tabindex="-1"></a>  }</span>
<span id="cb58-79"><a href="#cb58-79" tabindex="-1"></a>  </span>
<span id="cb58-80"><a href="#cb58-80" tabindex="-1"></a>  <span class="co"># 可视化 p 值分布（散点图）</span></span>
<span id="cb58-81"><a href="#cb58-81" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> m) { <span class="co"># 只绘制第m次模拟的 p 值分布</span></span>
<span id="cb58-82"><a href="#cb58-82" tabindex="-1"></a>    <span class="co"># 创建一个数据框，用于 ggplot2 绘图</span></span>
<span id="cb58-83"><a href="#cb58-83" tabindex="-1"></a>    p_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-84"><a href="#cb58-84" tabindex="-1"></a>      <span class="at">p_value =</span> p_values,</span>
<span id="cb58-85"><a href="#cb58-85" tabindex="-1"></a>      <span class="at">hypothesis =</span> <span class="fu">factor</span>(true_labels, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Null Hypothesis&quot;</span>, <span class="st">&quot;Alternative Hypothesis&quot;</span>))</span>
<span id="cb58-86"><a href="#cb58-86" tabindex="-1"></a>    )</span>
<span id="cb58-87"><a href="#cb58-87" tabindex="-1"></a>  </span>
<span id="cb58-88"><a href="#cb58-88" tabindex="-1"></a>    <span class="co"># 绘制散点图</span></span>
<span id="cb58-89"><a href="#cb58-89" tabindex="-1"></a>    p_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(p_data, <span class="fu">aes</span>(<span class="at">x =</span> hypothesis, <span class="at">y =</span> p_value, <span class="at">color =</span> hypothesis)) <span class="sc">+</span></span>
<span id="cb58-90"><a href="#cb58-90" tabindex="-1"></a>      <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span>  <span class="co"># 使用散点抖动效果</span></span>
<span id="cb58-91"><a href="#cb58-91" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> alpha, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span>  <span class="co"># 显著性水平线</span></span>
<span id="cb58-92"><a href="#cb58-92" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;P-value Distribution for Null and Alternative Hypotheses&quot;</span>,</span>
<span id="cb58-93"><a href="#cb58-93" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Hypothesis Type&quot;</span>,</span>
<span id="cb58-94"><a href="#cb58-94" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;P-value&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-95"><a href="#cb58-95" tabindex="-1"></a>      <span class="fu">theme_minimal</span>()</span>
<span id="cb58-96"><a href="#cb58-96" tabindex="-1"></a>  </span>
<span id="cb58-97"><a href="#cb58-97" tabindex="-1"></a>    <span class="co"># 打印图形</span></span>
<span id="cb58-98"><a href="#cb58-98" tabindex="-1"></a>    <span class="fu">print</span>(p_plot)</span>
<span id="cb58-99"><a href="#cb58-99" tabindex="-1"></a>  }</span>
<span id="cb58-100"><a href="#cb58-100" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>下面输出结果：</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># 计算平均值</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;Bonferroni校正&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fwer_bonf)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;Bonferroni校正&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdr_bonf)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;Bonferroni校正&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(tpr_bonf)</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;B-H校正&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fwer_bh)</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;B-H校正&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fdr_bh)</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;B-H校正&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(tpr_bh)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##      Bonferroni校正    B-H校正
## FWER    0.087300000 0.93050000
## FDR     0.004510088 0.09502215
## TPR     0.396736000 0.56106200</code></pre>
<p>从结果来看，可以发现Bonferroni校正比B-H校正更严格，可以更好地控制假阳性数量。Bonferroni校正由于更保守，通常会导致较低的真阳性检测率，而B-H校正则有更高的真阳性率。</p>
</div>
</div>
<div id="exercise-7.4" class="section level2">
<h2>Exercise 7.4</h2>
<div id="question-11" class="section level3">
<h3>Question</h3>
<ul>
<li>读取数据集aircondit</li>
<li>假设数据服从指数模型下，求风险率的最大似然估计。</li>
<li>使用bootstrap估计，并计算偏倚和标准误</li>
</ul>
<p>指数分布的最大似然估计计算公式为 <span class="math display">\[
\hat\lambda = \frac{n}{\sum_{i=1}^{n} x_i}
\]</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="co"># 加载 boot 包和数据</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;aircondit&quot;</span>)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a> <span class="co"># 样本大小</span></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a><span class="co"># 计算 λ 的 MLE</span></span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(x)</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a><span class="co"># 定义用于 Bootstrap 的统计量函数</span></span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>boot_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>  <span class="co"># 从数据中抽样</span></span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>  <span class="co"># 计算 λ 的 MLE</span></span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a>  n_boot <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_data)</span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a>  sum_boot <span class="ot">&lt;-</span> <span class="fu">sum</span>(sample_data)</span>
<span id="cb61-16"><a href="#cb61-16" tabindex="-1"></a>  lambda_boot <span class="ot">&lt;-</span> n_boot <span class="sc">/</span> sum_boot</span>
<span id="cb61-17"><a href="#cb61-17" tabindex="-1"></a>  <span class="fu">return</span>(lambda_boot)</span>
<span id="cb61-18"><a href="#cb61-18" tabindex="-1"></a>}</span>
<span id="cb61-19"><a href="#cb61-19" tabindex="-1"></a><span class="co"># 设置 Bootstrap 重复次数</span></span>
<span id="cb61-20"><a href="#cb61-20" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span></span>
<span id="cb61-21"><a href="#cb61-21" tabindex="-1"></a><span class="co"># 进行 Bootstrap</span></span>
<span id="cb61-22"><a href="#cb61-22" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-23"><a href="#cb61-23" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> boot_lambda, <span class="at">R =</span> R)</span>
<span id="cb61-24"><a href="#cb61-24" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" tabindex="-1"></a><span class="co"># 估计偏差</span></span>
<span id="cb61-26"><a href="#cb61-26" tabindex="-1"></a>bias_lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_results<span class="sc">$</span>t) <span class="sc">-</span> lambda_hat</span>
<span id="cb61-27"><a href="#cb61-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;偏差估计为：%.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, bias_lambda))</span></code></pre></div>
<pre><code>## 偏差估计为：0.001309</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>se_lambda <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_results<span class="sc">$</span>t)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;标准差估计为：%.6f</span><span class="sc">\n</span><span class="st">&quot;</span>, se_lambda))</span></code></pre></div>
<pre><code>## 标准差估计为：0.004314</code></pre>
</div>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<div id="question-12" class="section level3">
<h3>Question</h3>
<p>+使用standard normal, basic, percentile和BCa方法计算上一题中的<span class="math inline">\(\frac{1}{\lambda}\)</span>的95%的置信区间，并进行比较</p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>解决方法如下:</p>
<ul>
<li>首先要计算<span class="math inline">\(\frac{1}{\lambda}\)</span>的均值</li>
<li>利用Bootstrap采用估计<span class="math inline">\(\frac{1}{\lambda}\)</span>的均值</li>
<li>计算置信区间</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># 将 λ 转换为 θ = 1/λ</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>boot_theta <span class="ot">&lt;-</span> boot_results</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>boot_theta<span class="sc">$</span>t <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> boot_theta<span class="sc">$</span>t</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> lambda_hat</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a><span class="co"># 定义一个用于 Bootstrap 方法的统计量函数，用于计算平均故障间隔时间（θ = 1/λ）</span></span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>mean_time_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>  <span class="co"># 从原始数据中抽取 Bootstrap 样本</span></span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>  <span class="co"># &#39;data&#39; 是原始数据集，&#39;indices&#39; 是抽样索引（包含有放回的抽样位置）</span></span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  <span class="co"># 计算抽样样本的大小（观测值数量）</span></span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>  n_boot <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_data)</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>  <span class="co"># 计算抽样样本中所有故障时间的总和</span></span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>  sum_boot <span class="ot">&lt;-</span> <span class="fu">sum</span>(sample_data)</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>  <span class="co"># 计算 Bootstrap 样本的最大似然估计（MLE）λ的估计值</span></span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>  <span class="co"># λ 的 MLE 公式为 λ_hat = n / Σx_i，其中 n 是样本大小，Σx_i 是故障时间总和</span></span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> n_boot <span class="sc">/</span> sum_boot</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>  <span class="co"># 计算平均故障间隔时间 θ 的估计值，θ = 1/λ</span></span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>  theta_boot <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> lambda_hat</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>  <span class="co"># 返回 θ 的估计值作为 Bootstrap 样本的统计量</span></span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  <span class="fu">return</span>(theta_boot)</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>}</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">133</span>)  <span class="co"># 设置随机数种子，保证结果可重复</span></span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a><span class="co"># 数据：空调设备的故障时间（小时）</span></span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a>failure_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a> <span class="co"># 使用bootstrap方法计算</span></span>
<span id="cb65-27"><a href="#cb65-27" tabindex="-1"></a>bootstrap_mean_time_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> failure_times, <span class="at">statistic =</span> mean_time_boot, <span class="at">R =</span> <span class="dv">10000</span>)</span>
<span id="cb65-28"><a href="#cb65-28" tabindex="-1"></a></span>
<span id="cb65-29"><a href="#cb65-29" tabindex="-1"></a><span class="co"># 标准正态法置信区间</span></span>
<span id="cb65-30"><a href="#cb65-30" tabindex="-1"></a>norm_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_mean_time_results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb65-31"><a href="#cb65-31" tabindex="-1"></a> <span class="co"># 基本法置信区间</span></span>
<span id="cb65-32"><a href="#cb65-32" tabindex="-1"></a>basic_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_mean_time_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb65-33"><a href="#cb65-33" tabindex="-1"></a> <span class="co"># 百分位法置信区间</span></span>
<span id="cb65-34"><a href="#cb65-34" tabindex="-1"></a>perc_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_mean_time_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb65-35"><a href="#cb65-35" tabindex="-1"></a> <span class="co"># BCa 法置信区间</span></span>
<span id="cb65-36"><a href="#cb65-36" tabindex="-1"></a>bca_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_mean_time_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb65-37"><a href="#cb65-37" tabindex="-1"></a></span>
<span id="cb65-38"><a href="#cb65-38" tabindex="-1"></a>ci_methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;标准正态法&quot;</span>, <span class="st">&quot;基本法&quot;</span>, <span class="st">&quot;百分位法&quot;</span>, <span class="st">&quot;BCa 法&quot;</span>)</span>
<span id="cb65-39"><a href="#cb65-39" tabindex="-1"></a>lower_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(norm_ci<span class="sc">$</span>normal[<span class="dv">2</span>], basic_ci<span class="sc">$</span>basic[<span class="dv">4</span>], perc_ci<span class="sc">$</span>percent[<span class="dv">4</span>], bca_ci<span class="sc">$</span>bca[<span class="dv">4</span>])</span>
<span id="cb65-40"><a href="#cb65-40" tabindex="-1"></a>upper_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(norm_ci<span class="sc">$</span>normal[<span class="dv">3</span>], basic_ci<span class="sc">$</span>basic[<span class="dv">5</span>], perc_ci<span class="sc">$</span>percent[<span class="dv">5</span>], bca_ci<span class="sc">$</span>bca[<span class="dv">5</span>])</span>
<span id="cb65-41"><a href="#cb65-41" tabindex="-1"></a><span class="fu">data.frame</span>(ci_methods,lower_bounds,upper_bounds)</span></code></pre></div>
<pre><code>##   ci_methods lower_bounds upper_bounds
## 1 标准正态法     35.14162     181.0358
## 2     基本法     26.33333     169.3312
## 3   百分位法     46.83542     189.8333
## 4     BCa 法     57.08333     220.4830</code></pre>
<p>分析与总结：</p>
<ul>
<li><p>置信区间范围⽐较：BCa法的置信区间最为宽泛，尤其是上限远⾼于其他⽅法。标准正态法和基本法的置
信区间较⼩，表明它们对不对称分布的处理能⼒有限。百分位法和BCa法则较为灵活，能够捕捉数据的极端情况。</p></li>
<li><p>适⽤性⽐较：在实际应⽤中，BCa法和百分位法更适合数据分布可能偏斜、不对称的情况。BCa法由于进⾏了偏斜和加速的调整，因此是四种⽅法中最为稳健的选择。标准正态法和基本法在样本量较⼩或数据不正态分布时可能效果不佳。</p></li>
</ul>
</div>
</div>
</div>
<div id="homework5---10-23" class="section level1">
<h1>Homework5 - 10-23</h1>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<div id="question-13" class="section level3">
<h3>Question</h3>
<ul>
<li>导入数据集scor,并且计算样本估计量<span class="math inline">\(\hat{\theta} =
\frac{\hat{\lambda_1}}{\sum_{j=1}^{5} \hat{\lambda_j}}\)</span></li>
<li>利用bootstrap估计，并且计算偏差和标准误</li>
</ul>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<p>导入数据</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data</span>(scor)</span></code></pre></div>
<p>计算原始数据的样本估计结果</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># 主成分分析</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>original_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(scor, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a><span class="co"># 提取前五个主成分的特征值</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>explained_variances <span class="ot">&lt;-</span> (original_pca<span class="sc">$</span>sdev)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a><span class="co"># 计算原始数据的PC1在前五个主成分的比例</span></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>original_ratio <span class="ot">&lt;-</span> explained_variances[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(explained_variances[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<p>进行数据重采样与bootstrap方法计算偏差和标准误</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co"># 假设scor是一个数据框，含有数据集的样本</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)  <span class="co"># 获取数据集的行数</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a><span class="co"># 重复次数</span></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>boot_ratios <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>  <span class="co"># 有放回的抽样</span></span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>  bootstrap_sample <span class="ot">&lt;-</span> scor[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>  <span class="co"># 执行主成分分析</span></span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>  boot_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(bootstrap_sample, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>  <span class="co"># 提取前五个主成分的特征值</span></span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>  explained_variances <span class="ot">&lt;-</span> (boot_pca<span class="sc">$</span>sdev)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>  <span class="co"># 计算原始数据的PC1在前五个主成分的比例</span></span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>  boot_ratios[i] <span class="ot">&lt;-</span> explained_variances[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(explained_variances[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>}</span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a><span class="co"># 计算偏差</span></span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_ratios) <span class="sc">-</span> original_ratio</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a><span class="co"># 计算标准误</span></span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>standard_error <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_ratios)</span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a></span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始数据的样本估计值为&quot;</span>, original_ratio,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## 原始数据的样本估计值为 0.636196</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap方法的偏差为&quot;</span>, bias,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## bootstrap方法的偏差为 0.000629652</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap方法的标准误为&quot;</span>,standard_error)</span></code></pre></div>
<pre><code>## bootstrap方法的标准误为 0.0429845</code></pre>
</div>
</div>
<div id="exercise-7.10" class="section level2">
<h2>Exercise 7.10</h2>
<div id="question-14" class="section level3">
<h3>Question</h3>
<ul>
<li>在例子7.18中，利用cubic polynomial model替换Log-Log model</li>
<li>比较四个模型中的哪一个被交叉验证程序选择，并且根据最大调整<span class="math inline">\(R^2\)</span>选择哪个模型？</li>
</ul>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>获取数据</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span></code></pre></div>
<p>下面对以下模型进行模型评估： <span class="math display">\[
Y = \beta_0+\beta_1X+\epsilon
\]</span> <span class="math display">\[
Y = \beta_0+\beta_1X+\beta_2X^2+\epsilon
\]</span> <span class="math display">\[
Y = log(\beta_0)+\beta_1X+\epsilon
\]</span> <span class="math display">\[
Y = \beta_0+\beta_1X+\beta_2X^2+\beta_3X^3+\epsilon
\]</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> L1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a><span class="fu">lines</span>(a, yhat1, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> L2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a><span class="fu">lines</span>(a, yhat2, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> L3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a><span class="fu">lines</span>(a, yhat3, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a><span class="fu">plot</span>(chemical, magnetic, <span class="at">main=</span><span class="st">&quot;cubic&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>yhat4 <span class="ot">&lt;-</span> L4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a><span class="fu">lines</span>(a, yhat4, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- -->
应用交叉验证进行判断</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>  </span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>  </span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>  </span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a>  </span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb77-22"><a href="#cb77-22" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb77-23"><a href="#cb77-23" tabindex="-1"></a>}</span>
<span id="cb77-24"><a href="#cb77-24" tabindex="-1"></a><span class="co"># 根据误差比较</span></span>
<span id="cb77-25"><a href="#cb77-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;均值为&quot;</span>, <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## 均值为 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R^2为&quot;</span>, <span class="fu">c</span>(<span class="fu">summary</span>(J1)<span class="sc">$</span>r.squared,<span class="fu">summary</span>(J2)<span class="sc">$</span>r.squared,<span class="fu">summary</span>(J3)<span class="sc">$</span>r.squared,<span class="fu">summary</span>(J4)<span class="sc">$</span>r.squared))</span></code></pre></div>
<pre><code>## R^2为 0.5410887 0.6070129 0.5375745 0.6176173</code></pre>
<p>根据误差结果三次多项式是最佳选择。根据最大调整<span class="math inline">\(R^2\)</span>的结果二次多项式是最佳选择。</p>
</div>
</div>
<div id="exercise-8.1" class="section level2">
<h2>Exercise 8.1</h2>
<div id="question-15" class="section level3">
<h3>Question</h3>
<ul>
<li>将相等分布的双样本Cramér-von
Mises检验作为置换检验测试例8.1的数据。</li>
</ul>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;chickwts&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="co"># 选择两个饲料组作为样本</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>feed1 <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;horsebean&quot;</span>]</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>feed2 <span class="ot">&lt;-</span> chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a><span class="co"># Cramér-von Mises统计量计算函数</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>cramer_von_mises <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>  <span class="co"># 计算经验分布函数</span></span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>  ecdf_x <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  ecdf_y <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>  <span class="co"># 合并并排序样本</span></span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(x, y))</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>  <span class="co"># 计算Cramér-von Mises统计量</span></span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">ecdf_x</span>(combined) <span class="sc">-</span> <span class="fu">ecdf_y</span>(combined))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (n1 <span class="sc">*</span> n2 <span class="sc">/</span> (n1 <span class="sc">+</span> n2))</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>  <span class="fu">return</span>(stat)</span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>}</span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a><span class="co"># 置换检验函数</span></span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>cramer_von_mises_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">n_permutations =</span> <span class="dv">1000</span>) {</span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a>  <span class="co"># 计算原始统计量</span></span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises</span>(x, y)</span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a>  <span class="co"># 合并样本</span></span>
<span id="cb81-24"><a href="#cb81-24" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb81-25"><a href="#cb81-25" tabindex="-1"></a>  <span class="co"># 初始化置换统计量向量</span></span>
<span id="cb81-26"><a href="#cb81-26" tabindex="-1"></a>  permuted_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb81-27"><a href="#cb81-27" tabindex="-1"></a>  <span class="co"># 进行置换</span></span>
<span id="cb81-28"><a href="#cb81-28" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb81-29"><a href="#cb81-29" tabindex="-1"></a>    permuted_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined)</span>
<span id="cb81-30"><a href="#cb81-30" tabindex="-1"></a>    new_x <span class="ot">&lt;-</span> permuted_sample[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)]</span>
<span id="cb81-31"><a href="#cb81-31" tabindex="-1"></a>    new_y <span class="ot">&lt;-</span> permuted_sample[(<span class="fu">length</span>(x) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(combined)]</span>
<span id="cb81-32"><a href="#cb81-32" tabindex="-1"></a>    permuted_stats[i] <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises</span>(new_x, new_y)</span>
<span id="cb81-33"><a href="#cb81-33" tabindex="-1"></a>  }</span>
<span id="cb81-34"><a href="#cb81-34" tabindex="-1"></a>  <span class="co"># 计算p值</span></span>
<span id="cb81-35"><a href="#cb81-35" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(permuted_stats <span class="sc">&gt;=</span> observed_stat)</span>
<span id="cb81-36"><a href="#cb81-36" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed_stat =</span> observed_stat, <span class="at">p_value =</span> p_value))</span>
<span id="cb81-37"><a href="#cb81-37" tabindex="-1"></a>}</span>
<span id="cb81-38"><a href="#cb81-38" tabindex="-1"></a><span class="co"># 进行置换检验</span></span>
<span id="cb81-39"><a href="#cb81-39" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb81-40"><a href="#cb81-40" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises_permutation_test</span>(feed1, feed2, <span class="at">n_permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb81-41"><a href="#cb81-41" tabindex="-1"></a></span>
<span id="cb81-42"><a href="#cb81-42" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb81-43"><a href="#cb81-43" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Cramer-von Mises检验统计量结果:&quot;</span>, result<span class="sc">$</span>observed_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Cramer-von Mises检验统计量结果: 15.86667</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, result<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value: 0.009</code></pre>
<p>从结果来看，由于<span class="math inline">\(p=0.009&lt;0.01\)</span>，因此两种饲料的鸡体重分布显著不同</p>
</div>
</div>
<div id="exercise-8.2" class="section level2">
<h2>Exercise 8.2</h2>
<div id="question-16" class="section level3">
<h3>Question</h3>
<ul>
<li>将独立性的二元斯皮尔曼秩相关检验作为置换检验。</li>
<li>将置换检验的显著性水平与cor.检验报告的相同样本的p值进行比较。</li>
</ul>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>由于题目没有指定数据集，本题使用服从正态分布的随机变量来进行测试。</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co"># 生成示例数据</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a><span class="co"># 定义置换检验函数</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>spearman_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">n_permutations =</span> <span class="dv">1000</span>) {</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>  <span class="co"># 计算原始样本的Spearman相关系数</span></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a>  <span class="co"># 初始化置换统计量向量</span></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>  permuted_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a>  <span class="co"># 进行置换</span></span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>    permuted_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)  <span class="co"># 随机打乱y</span></span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a>    permuted_stats[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, permuted_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a>  }</span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a>  <span class="co"># 计算置换p值</span></span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(permuted_stats) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_stat))</span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">observed_stat =</span> observed_stat, <span class="at">p_value =</span> p_value))</span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>}</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a></span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a><span class="co"># 运行置换检验</span></span>
<span id="cb85-23"><a href="#cb85-23" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb85-24"><a href="#cb85-24" tabindex="-1"></a>result_permutation <span class="ot">&lt;-</span> <span class="fu">spearman_permutation_test</span>(x, y, <span class="at">n_permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb85-25"><a href="#cb85-25" tabindex="-1"></a></span>
<span id="cb85-26"><a href="#cb85-26" tabindex="-1"></a><span class="co"># 计算Spearman相关系数和p值</span></span>
<span id="cb85-27"><a href="#cb85-27" tabindex="-1"></a>result_cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb85-28"><a href="#cb85-28" tabindex="-1"></a></span>
<span id="cb85-29"><a href="#cb85-29" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb85-30"><a href="#cb85-30" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman相关系数:&quot;</span>, result_permutation<span class="sc">$</span>observed_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman相关系数: -0.0437455</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Permutation test p值:&quot;</span>, result_permutation<span class="sc">$</span>p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Permutation test p值: 0.742</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;cor.test p值:&quot;</span>, result_cor_test<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## cor.test p值: 0.7623287</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值的差距为：&quot;</span>, <span class="fu">abs</span>(result_permutation<span class="sc">$</span>p_value<span class="sc">-</span>result_cor_test<span class="sc">$</span>p.value))</span></code></pre></div>
<pre><code>## p值的差距为： 0.02032872</code></pre>
<p>从结果上来看，p值的差距为0.02较为相近，两种方法在显著性水平上的一致性较高。但是在样本较小的时候，p值的差距较大。</p>
</div>
</div>
</div>
<div id="homework6---10-28" class="section level1">
<h1>Homework6 - 10-28</h1>
<div id="exercise-9.3" class="section level2">
<h2>Exercise 9.3</h2>
<div id="question-17" class="section level3">
<h3>Question</h3>
<ul>
<li>使用Metropolis-Hastings采样器生成服从标准柯西分布的随机变量。</li>
<li>丢弃链的前1000个，观察生成的观测值的十分位数，并与标准柯西分布的十分位数进行比较</li>
</ul>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p>服从<span class="math inline">\((\theta,\eta)\)</span>的柯西分布的密度函数为：
<span class="math display">\[
f(x) = \frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad
-\infty&lt;x&lt;\infty,\ \theta&gt;0
\]</span> 则标准柯西分布<span class="math inline">\((\theta=1,\eta=0)\)</span>的密度函数为： <span class="math display">\[
f(x) = \frac{1}{\pi(1+x^2)},\quad -\infty&lt;x&lt;\infty
\]</span> 设置标准柯西分布的密度函数</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co"># 设置目标分布的密度函数</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>target_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>  <span class="fu">return</span> (<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>}</span></code></pre></div>
<p>定义采样函数，在该采样函数的定义中，提议分布是方差为1的正态分布</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co"># iter迭代次数，start是起始点</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(iter, start, proposal_sd) {</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iter) <span class="co"># 保存样本</span></span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> start      <span class="co"># 初始值 </span></span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iter) {</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>    <span class="co"># 从提议分布中采样，生成新状态</span></span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> samples[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> proposal_sd)</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>    <span class="co"># 计算接受率</span></span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">target_density</span>(proposal) <span class="sc">/</span> <span class="fu">target_density</span>(samples[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>    <span class="co"># 以接受率的最小值为界进行判断</span></span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb94-13"><a href="#cb94-13" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> proposal <span class="co"># 接受提议样本</span></span>
<span id="cb94-14"><a href="#cb94-14" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb94-15"><a href="#cb94-15" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> samples[i <span class="sc">-</span> <span class="dv">1</span>] <span class="co"># 拒绝提议，保留当前样本</span></span>
<span id="cb94-16"><a href="#cb94-16" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb94-17"><a href="#cb94-17" tabindex="-1"></a>    }</span>
<span id="cb94-18"><a href="#cb94-18" tabindex="-1"></a>  }</span>
<span id="cb94-19"><a href="#cb94-19" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb94-20"><a href="#cb94-20" tabindex="-1"></a>}</span></code></pre></div>
<p>进行采样并可视化效果</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span>      <span class="co"># 迭代次数</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>start_value <span class="ot">&lt;-</span> <span class="dv">0</span>         <span class="co"># 起始点</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>proposal_sd <span class="ot">&lt;-</span> <span class="dv">1</span>         <span class="co"># 提议分布的标准差</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(iterations, start_value, proposal_sd)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1000</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> samples[index]</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a><span class="fu">plot</span>(index, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>进行十分位数的比较</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples[<span class="dv">1000</span><span class="sc">:</span><span class="dv">10000</span>], <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a><span class="co"># 设置位置参数和尺度参数</span></span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>location <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 默认位置参数</span></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># 默认尺度参数</span></span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a><span class="co"># 计算十分位数</span></span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>decile_probs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>)  <span class="co"># 十分位数对应的概率</span></span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a>deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(decile_probs, location, scale)</span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb96-12"><a href="#cb96-12" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb96-13"><a href="#cb96-13" tabindex="-1"></a>  <span class="at">Sample_Quantiles =</span> sample_deciles,</span>
<span id="cb96-14"><a href="#cb96-14" tabindex="-1"></a>  <span class="at">Theoretical_Quantiles =</span> deciles,</span>
<span id="cb96-15"><a href="#cb96-15" tabindex="-1"></a>  <span class="at">abs_diff =</span> <span class="fu">abs</span>(sample_deciles<span class="sc">-</span>deciles)</span>
<span id="cb96-16"><a href="#cb96-16" tabindex="-1"></a>)</span>
<span id="cb96-17"><a href="#cb96-17" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##      Sample_Quantiles Theoretical_Quantiles    abs_diff
## 0%       -15.74545187                  -Inf         Inf
## 10%       -2.81748908            -3.0776835 0.260194459
## 20%       -1.40238695            -1.3763819 0.026005025
## 30%       -0.73779604            -0.7265425 0.011253513
## 40%       -0.33349017            -0.3249197 0.008570471
## 50%       -0.01617099             0.0000000 0.016170986
## 60%        0.30694914             0.3249197 0.017970558
## 70%        0.72330174             0.7265425 0.003240788
## 80%        1.37263397             1.3763819 0.003747948
## 90%        3.02836810             3.0776835 0.049315442
## 100%      19.08936577                   Inf         Inf</code></pre>
<p>比较观察可知，采样器生成的结果的十分位数与理论值相近。</p>
</div>
</div>
<div id="exercise-9.8" class="section level2">
<h2>Exercise 9.8</h2>
<div id="question-18" class="section level3">
<h3>Question</h3>
<ul>
<li>使用Gibbs采样器生成服从双变量密度的链</li>
</ul>
</div>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p>双变量密度表示如下： <span class="math display">\[
f(x,y)\propto\binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad x=0,1,...,n,\
0\leq y\leq1
\]</span></p>
<p>由题目得到。当<span class="math inline">\(a,b,n\)</span>确定时，条件分布是<span class="math inline">\(Binomial(n,y)\)</span>和<span class="math inline">\(Beta(x+a,n-x+b)\)</span></p>
<p><span class="math display">\[
f(x|y)=Binomial(n,y)=\frac{n!}{y!(n-y)!}
\]</span></p>
<p><span class="math display">\[
f(y|x)=Beta(x+a, n-x+b) = \int_0^1 t^{x+a-1} (1-t)^{n-x+b-1} \, dt
\]</span></p>
<p>可以证明<span class="math inline">\(y\)</span>的分布是<span class="math inline">\(y \sim Beta(a,b)\)</span></p>
<p>因此可以进行Gibbs采样如下</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a><span class="co"># 链的初始值</span></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="fl">0.5</span>)  <span class="co"># 随机初始化 x</span></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,a,b)  <span class="co"># 随机初始化 y</span></span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0, y0)</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a></span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a><span class="co"># 进行Gibbs采样</span></span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>}</span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a><span class="co"># 丢弃前1000个数据</span></span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a></span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a><span class="co"># 可视化Gibbs采样</span></span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="st">&#39;x&#39;</span>,</span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a>  <span class="at">ylab=</span><span class="st">&#39;y&#39;</span>, <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise</h2>
<div id="question-19" class="section level3">
<h3>Question</h3>
<ul>
<li>使用Gelman-Rubin method评估上两题的收敛性</li>
</ul>
</div>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<p>修改起始点来判断收敛速度</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>  <span class="co">#row means</span></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>  <span class="co">#between variance est.</span></span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>  <span class="co">#within est.</span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)</span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>  <span class="co">#upper variance est.</span></span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a>  <span class="co">#G-R statistic</span></span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a>}</span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a><span class="co">#number of chains to generate</span></span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span></span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a><span class="co">#length of chains</span></span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a><span class="co">#burn-in length</span></span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb99-30"><a href="#cb99-30" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb99-31"><a href="#cb99-31" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb99-32"><a href="#cb99-32" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb99-33"><a href="#cb99-33" tabindex="-1"></a></span>
<span id="cb99-34"><a href="#cb99-34" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb99-35"><a href="#cb99-35" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n, x0[i], sigma)</span>
<span id="cb99-36"><a href="#cb99-36" tabindex="-1"></a></span>
<span id="cb99-37"><a href="#cb99-37" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb99-38"><a href="#cb99-38" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb99-39"><a href="#cb99-39" tabindex="-1"></a><span class="co"># 进行矩阵变化，psi是一个矩阵</span></span>
<span id="cb99-40"><a href="#cb99-40" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb99-41"><a href="#cb99-41" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb99-42"><a href="#cb99-42" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.76673</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>    <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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6B5fH9sY7M+yiGIW5prjk1agzcenuABVPXPzgPOwPdoAbcKjujzXHJ+kAj3/8hgZoOfbj1UfHx2galywPoHWGJ+kAj3c7SID5E06HaBNNTNZn0BrjE/KQXTzBc6Y0VvkILEJUP0469UNolcZn9TT+EMdw+eP1Rf2Yqap9Rn83edurVY1jV9dfGwE2p87MQtlTfL+y0D6eqEseI8q//qBjncxxSzMFceHSxkggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAgUbhAub4KuA6a5/xkpWyBDo+zgQHa5/xkpWiB6sfZwADNc37yVqJogU6Ps4EBqlYoK0ULxBhoks2+FcoKAq2aTfYxIgKtmU3uITQCrZr87Q8CrZn2OT9ZQaD10j7nJyuFCwSlg0AggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAggUAGPP/0ebfbOuc+5q5JehDIgEqg7fv9m83rMwiBDNgL9HJ/t3/z9P2X3HVJDQIZgEAg8Xz79svm0IW9z12V5CCQCc+37s3n3cO7x9wVSQ4CgQQCmfDgDry+SRgCmdD2XQ+MgWbksGoMQtgsJFb4ZmG5j1Bj+uOXo7fqNiyFQCZFZKJwgcIcXxKj0tuuqzsNOz+JVylS6QLtDnGWq6DVwIJN7YpvEN0UkflMmcmSAoV3k8M5HDOanYdIgoIRaLEcTntmcyivQOU7tRaBdrnGQ8Yljg2iXf/Hw/viDSpaoMvwpXcoXQu0a/vr7iYEUnLw7pi4IcomkOv+UC7rE+iwQRycW9QhEs+lDP80vitQ9kWMadYpULM5hUdW60AjlzK8ArlaoOKH0SVP4wN3XFajhCvRXYHqA3Llz8NKboGi9ou6PLNUJQaJF2iHQHIO81suQ48WvJRx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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.44</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework7---11.04" class="section level1">
<h1>Homework7 - 11.04</h1>
<div id="exercise-11.3" class="section level2">
<h2>Exercise 11.3</h2>
<div id="question-20" class="section level3">
<h3>Question</h3>
<ul>
<li>编写一个函数计算函数的第<span class="math inline">\(k\)</span>项</li>
<li>计算<span class="math inline">\(k\)</span>项的总和</li>
<li>计算当<span class="math inline">\(a=(1,2)^T\)</span>时的总和</li>
</ul>
</div>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<p>函数为：</p>
<p><span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k} \frac{\| a
\|^{2k+2}}{(2k+1)(2k+2)}
\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}
\]</span></p>
<p>该函数的第三项在<span class="math inline">\(k\)</span>较大时会超出计算机的存储范围。需要将<span class="math inline">\(Gamma\)</span>函数转换为<span class="math inline">\(lgGamme\)</span>函数进行计算。</p>
<p>下面计算函数的第<span class="math inline">\(k\)</span>项</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>d <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a><span class="co"># 计算第k项的函数</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>numk <span class="ot">=</span> <span class="cf">function</span>(k, a){</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>  l1 <span class="ot">=</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span>(<span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k)</span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>  l2 <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">log</span>(<span class="fu">norm</span>(a, <span class="at">type =</span> <span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>  l3 <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>  result <span class="ot">=</span> l1<span class="sc">*</span>l2<span class="sc">*</span>l3</span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a>}</span></code></pre></div>
<p>对函数的<span class="math inline">\(k\)</span>项求和</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>num <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="cf">for</span> (num <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span><span class="sc">:</span>num</span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>  odd <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">0</span><span class="sc">:</span>num)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>  even <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">0</span><span class="sc">:</span>num)<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>  i <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="at">length =</span> num<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>  a <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>  d <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>  l3 <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>  l1 <span class="ot">=</span> i<span class="sc">/</span><span class="fu">factorial</span>(k)<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k</span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>  l2 <span class="ot">=</span> <span class="fu">norm</span>(a, <span class="at">type =</span> <span class="st">&quot;2&quot;</span>)<span class="sc">^</span>even<span class="sc">/</span>odd<span class="sc">/</span>even</span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">sum</span>(l1<span class="sc">*</span>l2<span class="sc">*</span>l3))</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.8657404
## [1] 0.8837167
## [1] 0.8802057
## [1] 0.8808884
## [1] 0.8807604
## [1] 0.8807833
## [1] 0.8807794
## [1] 0.88078
## [1] 0.8807799
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078
## [1] 0.88078</code></pre>
</div>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<div id="question-21" class="section level3">
<h3>Question</h3>
<ul>
<li>写一个函数解方程</li>
<li>与练习11.4中的值进行对比</li>
</ul>
</div>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<p>需要解的方程为：</p>
<p><span class="math display">\[
\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du
=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi
k}\Gamma(\frac{k}{2})}\int_{0}^{c_{k}}(1+\frac{u^2}{k})^{-(k+1)/2}du
\]</span></p>
<p>对于<span class="math inline">\(a\)</span>，有</p>
<p><span class="math display">\[
c_k = \sqrt{\frac{a^2k}{k+1-a^2}}
\]</span></p>
<p>求解方程我们可以将其转化为方程零点的求解，然后运用内置函数<code>uniroot</code>，求解变量是a</p>
<p><span class="math display">\[
\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du
-\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi
k}\Gamma(\frac{k}{2})}\int_{0}^{c_{k}}(1+\frac{u^2}{k})^{-(k+1)/2}du = 0
\]</span></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>c_k <span class="ot">=</span> <span class="cf">function</span>(a,k){</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>}</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>integral <span class="ot">=</span> <span class="cf">function</span>(u,k){</span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a>}</span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a>expr <span class="ot">=</span> <span class="cf">function</span>(a,k){</span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a>  integral1 <span class="ot">=</span> <span class="cf">function</span>(u){</span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a>    <span class="fu">integral</span>(u,k)</span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a>  }</span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a>  c <span class="ot">=</span> <span class="fu">c_k</span>(a,k<span class="dv">-1</span>)</span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a>  l1 <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))</span>
<span id="cb106-16"><a href="#cb106-16" tabindex="-1"></a>  res <span class="ot">=</span> l1 <span class="sc">*</span> <span class="fu">integrate</span>(integral1,<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c)<span class="sc">$</span>value</span>
<span id="cb106-17"><a href="#cb106-17" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb106-18"><a href="#cb106-18" tabindex="-1"></a>}</span>
<span id="cb106-19"><a href="#cb106-19" tabindex="-1"></a></span>
<span id="cb106-20"><a href="#cb106-20" tabindex="-1"></a><span class="co"># 进行迭代</span></span>
<span id="cb106-21"><a href="#cb106-21" tabindex="-1"></a>result1 <span class="ot">=</span> <span class="cf">function</span>(a){</span>
<span id="cb106-22"><a href="#cb106-22" tabindex="-1"></a>  <span class="fu">expr</span>(a,k) <span class="sc">-</span> <span class="fu">expr</span>(a,k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb106-23"><a href="#cb106-23" tabindex="-1"></a>}</span>
<span id="cb106-24"><a href="#cb106-24" tabindex="-1"></a></span>
<span id="cb106-25"><a href="#cb106-25" tabindex="-1"></a>resl <span class="ot">=</span> <span class="cf">function</span>(k){</span>
<span id="cb106-26"><a href="#cb106-26" tabindex="-1"></a>  r <span class="ot">=</span> <span class="fu">uniroot</span>(result1, <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.01</span>))<span class="sc">$</span>root</span>
<span id="cb106-27"><a href="#cb106-27" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb106-28"><a href="#cb106-28" tabindex="-1"></a>}</span>
<span id="cb106-29"><a href="#cb106-29" tabindex="-1"></a></span>
<span id="cb106-30"><a href="#cb106-30" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">15</span>)){</span>
<span id="cb106-31"><a href="#cb106-31" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">resl</span>(k))</span>
<span id="cb106-32"><a href="#cb106-32" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1.492073
## [1] 1.533555
## [1] 1.562745
## [1] 1.584429
## [1] 1.601184
## [1] 1.614516
## [1] 1.625389
## [1] 1.634418
## [1] 1.642026
## [1] 1.648552
## [1] 1.654175
## [1] 1.659099</code></pre>
</div>
</div>
<div id="exercise-4" class="section level2">
<h2>Exercise</h2>
<div id="question-22" class="section level3">
<h3>Question</h3>
<ul>
<li>使用E-M算法来估计右截断的指数分布参数λ</li>
<li>将结果与MLE算法进行比较</li>
</ul>
</div>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co"># 初始化观测数据</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 截断值</span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a><span class="co"># E-M算法的实现</span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>EM_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, tau, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>  </span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  <span class="co"># 初始化lambda</span></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  </span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>  <span class="co"># 进行E-M迭代</span></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>    <span class="co"># E步：计算潜在变量T的期望</span></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a>    T_expect <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n)</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>      <span class="cf">if</span> (Y[i] <span class="sc">&lt;</span> tau) {</span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>        T_expect[i] <span class="ot">&lt;-</span> Y[i]</span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a>        T_expect[i] <span class="ot">&lt;-</span> tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda</span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a>      }</span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a>    }</span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a>    </span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a>    <span class="co"># M步：最大化对数似然函数，更新lambda</span></span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a>    <span class="co"># 计算新的lambda</span></span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(T_expect)</span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a>    </span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a>    <span class="co"># 检查是否收敛</span></span>
<span id="cb108-29"><a href="#cb108-29" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb108-30"><a href="#cb108-30" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb108-31"><a href="#cb108-31" tabindex="-1"></a>    }</span>
<span id="cb108-32"><a href="#cb108-32" tabindex="-1"></a>    </span>
<span id="cb108-33"><a href="#cb108-33" tabindex="-1"></a>    <span class="co"># 更新lambda</span></span>
<span id="cb108-34"><a href="#cb108-34" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb108-35"><a href="#cb108-35" tabindex="-1"></a>  }</span>
<span id="cb108-36"><a href="#cb108-36" tabindex="-1"></a>  </span>
<span id="cb108-37"><a href="#cb108-37" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb108-38"><a href="#cb108-38" tabindex="-1"></a>}</span>
<span id="cb108-39"><a href="#cb108-39" tabindex="-1"></a></span>
<span id="cb108-40"><a href="#cb108-40" tabindex="-1"></a><span class="co"># 运行E-M算法来估计lambda</span></span>
<span id="cb108-41"><a href="#cb108-41" tabindex="-1"></a>lambda_EM <span class="ot">&lt;-</span> <span class="fu">EM_algorithm</span>(Y, tau)</span>
<span id="cb108-42"><a href="#cb108-42" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;E-M估计的lambda值:&quot;</span>, lambda_EM, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## E-M估计的lambda值: 1.037036</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co"># MLE的估计</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>MLE_lambda <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(Y[Y <span class="sc">&lt;</span> tau]) <span class="sc">/</span> <span class="fu">length</span>(Y[Y <span class="sc">&lt;</span> tau])</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE估计的lambda值:&quot;</span>, MLE_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE估计的lambda值: 1.071429</code></pre>
</div>
</div>
</div>
<div id="homework8---11-11" class="section level1">
<h1>Homework8 - 11-11</h1>
<div id="exercise-11.7" class="section level2">
<h2>Exercise 11.7</h2>
<div id="question-23" class="section level3">
<h3>Question</h3>
<ul>
<li>使用单纯形法求解在一定的限制条件下算式<span class="math inline">\(4x+2y+9z\)</span>的最小值</li>
</ul>
</div>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<p>问题为：</p>
<p><span class="math display">\[
min(4x+2y+9z)\\
2x+y+z \leq 2\\
x-y+3z \leq 3\\
x \geq 0,y \geq 0,z \geq 0
\]</span></p>
<p>下面使用单纯形法求解</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>A1 <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">maxi =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
</div>
</div>
<div id="exercise-p204_3" class="section level2">
<h2>Exercise p204_3</h2>
<div id="question-24" class="section level3">
<h3>Question</h3>
<ul>
<li>使用循环和<span class="math inline">\(lapply()\)</span>将此列表中存储的公式拟合线性模型，数据集使用<span class="math inline">\(mtcars\)</span>。</li>
</ul>
</div>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<p>首先加载<span class="math inline">\(mtcars\)</span>数据集，然后用循环和函数<span class="math inline">\(lapply()\)</span>进行数据分析。</p>
<p>首先使用函数<span class="math inline">\(lapply()\)</span></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  mpg <span class="sc">~</span> disp, <span class="co"># 探索线性关系</span></span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp), <span class="co"># 探索倒数关系</span></span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt, <span class="co"># mpg与disp和wt的线性关系</span></span>
<span id="cb114-6"><a href="#cb114-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt <span class="co"># mpg 与 disp 的倒数和 wt 的线性关系</span></span>
<span id="cb114-7"><a href="#cb114-7" tabindex="-1"></a>)</span>
<span id="cb114-8"><a href="#cb114-8" tabindex="-1"></a><span class="co"># 使用 lapply() 循环应用每个公式</span></span>
<span id="cb114-9"><a href="#cb114-9" tabindex="-1"></a>models_ex3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formula) {</span>
<span id="cb114-10"><a href="#cb114-10" tabindex="-1"></a>  <span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars)  <span class="co"># 拟合线性回归模型</span></span>
<span id="cb114-11"><a href="#cb114-11" tabindex="-1"></a>})</span>
<span id="cb114-12"><a href="#cb114-12" tabindex="-1"></a><span class="co"># 打印模型摘要</span></span>
<span id="cb114-13"><a href="#cb114-13" tabindex="-1"></a>models_ex3</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>然后使用循环进行分析</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="co"># 创建一个空列表来存储模型</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>models_loop_ex3 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a><span class="co"># 使用for循环拟合线性模型</span></span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  models_loop_ex3[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>}</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a><span class="fu">print</span>(models_loop_ex3)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
</div>
<div id="exercise-p204_4" class="section level2">
<h2>Exercise p204_4</h2>
<div id="question-25" class="section level3">
<h3>Question</h3>
<ul>
<li>使用循环和<span class="math inline">\(lapply()\)</span>并使用线性模型拟合mpg和disp，对数据集mtcars进行自举重复，且不使用匿名函数。</li>
</ul>
</div>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="co"># 定义 bootstrap 列表</span></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>})</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a><span class="co"># 使用线性模型拟合</span></span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>}</span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a><span class="co"># 使用 lapply 将 fit_model 函数应用于每个 bootstrap 复制</span></span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>models_ex4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_model)</span>
<span id="cb118-15"><a href="#cb118-15" tabindex="-1"></a></span>
<span id="cb118-16"><a href="#cb118-16" tabindex="-1"></a><span class="co"># 创建一个空列表来存储模型</span></span>
<span id="cb118-17"><a href="#cb118-17" tabindex="-1"></a>models_loop_ex4 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb118-18"><a href="#cb118-18" tabindex="-1"></a></span>
<span id="cb118-19"><a href="#cb118-19" tabindex="-1"></a>j <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb118-20"><a href="#cb118-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> bootstraps){</span>
<span id="cb118-21"><a href="#cb118-21" tabindex="-1"></a>  j <span class="ot">=</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb118-22"><a href="#cb118-22" tabindex="-1"></a>  models_loop_ex4[[j]] <span class="ot">=</span> <span class="fu">lm</span>(i<span class="sc">$</span>mpg <span class="sc">~</span> i<span class="sc">$</span>disp,<span class="at">data =</span> i)</span>
<span id="cb118-23"><a href="#cb118-23" tabindex="-1"></a>}</span>
<span id="cb118-24"><a href="#cb118-24" tabindex="-1"></a></span>
<span id="cb118-25"><a href="#cb118-25" tabindex="-1"></a><span class="fu">print</span>(models_ex4)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59804     -0.03798  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.38760     -0.03411  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.27667     -0.04176  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.25457     -0.03271  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.07161     -0.04129  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.51716     -0.03936  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.74975     -0.04647  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.47887     -0.03405  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.57749     -0.04043  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.60505     -0.04017</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">print</span>(models_loop_ex4)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    29.59804     -0.03798  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    27.38760     -0.03411  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    30.27667     -0.04176  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    27.25457     -0.03271  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    29.07161     -0.04129  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    28.51716     -0.03936  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    31.74975     -0.04647  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    27.47887     -0.03405  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    29.57749     -0.04043  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = i$mpg ~ i$disp, data = i)
## 
## Coefficients:
## (Intercept)       i$disp  
##    29.60505     -0.04017</code></pre>
</div>
</div>
<div id="exercise-p204_5" class="section level2">
<h2>Exercise p204_5</h2>
<div id="question-26" class="section level3">
<h3>Question</h3>
<ul>
<li>对于exercise3和exercise4，提取结果中的<span class="math inline">\(R^2\)</span></li>
</ul>
</div>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<p>对于exercise3和exercise4中的模型结果进行计算</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a><span class="co"># 对于ex3的模型</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>rex3 <span class="ot">=</span> <span class="fu">lapply</span>(models_ex3,rsq)</span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>rex3_loop <span class="ot">=</span> <span class="fu">lapply</span>(models_loop_ex3,rsq)</span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>rex4 <span class="ot">=</span> <span class="fu">lapply</span>(models_ex4,rsq)</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a>rex4_loop <span class="ot">=</span> <span class="fu">lapply</span>(models_loop_ex4,rsq)</span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a>df1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;mpg ~ disp&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp)&quot;</span>,<span class="st">&quot;mpg ~ disp + wt&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp) + wt&quot;</span>),</span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>  <span class="at">lapply_R2 =</span> <span class="fu">as.double</span>(<span class="fu">unlist</span>(rex3)),</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a>  <span class="at">loop_R2 =</span> <span class="fu">as.double</span>(<span class="fu">unlist</span>(rex3_loop))</span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a>)</span>
<span id="cb122-12"><a href="#cb122-12" tabindex="-1"></a>df2 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb122-13"><a href="#cb122-13" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;bootstraps1&quot;</span>,<span class="st">&quot;bootstraps2&quot;</span>,<span class="st">&quot;bootstraps3&quot;</span>,<span class="st">&quot;bootstraps4&quot;</span>,<span class="st">&quot;bootstraps5&quot;</span>,<span class="st">&quot;bootstraps6&quot;</span>,</span>
<span id="cb122-14"><a href="#cb122-14" tabindex="-1"></a>           <span class="st">&quot;bootstraps7&quot;</span>,<span class="st">&quot;bootstraps8&quot;</span>,<span class="st">&quot;bootstraps9&quot;</span>,<span class="st">&quot;bootstraps10&quot;</span>),</span>
<span id="cb122-15"><a href="#cb122-15" tabindex="-1"></a>  <span class="at">lapply_R2 =</span> <span class="fu">as.double</span>(<span class="fu">unlist</span>(rex4)),</span>
<span id="cb122-16"><a href="#cb122-16" tabindex="-1"></a>  <span class="at">loop_R2 =</span> <span class="fu">as.double</span>(<span class="fu">unlist</span>(rex4_loop))</span>
<span id="cb122-17"><a href="#cb122-17" tabindex="-1"></a>)</span>
<span id="cb122-18"><a href="#cb122-18" tabindex="-1"></a><span class="fu">print</span>(df1)</span></code></pre></div>
<pre><code>##                     Name lapply_R2   loop_R2
## 1             mpg ~ disp 0.7183433 0.7183433
## 2      mpg ~ I(1 / disp) 0.8596865 0.8596865
## 3        mpg ~ disp + wt 0.7809306 0.7809306
## 4 mpg ~ I(1 / disp) + wt 0.8838038 0.8838038</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">print</span>(df2)</span></code></pre></div>
<pre><code>##            Name lapply_R2   loop_R2
## 1   bootstraps1 0.6497636 0.6497636
## 2   bootstraps2 0.6820834 0.6820834
## 3   bootstraps3 0.7530595 0.7530595
## 4   bootstraps4 0.6101709 0.6101709
## 5   bootstraps5 0.7226119 0.7226119
## 6   bootstraps6 0.7533418 0.7533418
## 7   bootstraps7 0.7311415 0.7311415
## 8   bootstraps8 0.6293502 0.6293502
## 9   bootstraps9 0.6554375 0.6554375
## 10 bootstraps10 0.7238971 0.7238971</code></pre>
</div>
</div>
<div id="exercise-p213_3" class="section level2">
<h2>Exercise p213_3</h2>
<div id="question-27" class="section level3">
<h3>Question</h3>
<ul>
<li>利用题目中所给的方法模拟非正态数据的t检验性能。</li>
<li>使用<code>sapply()</code>和匿名函数从每个试验中提取p值。</li>
</ul>
</div>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<p>首先对题目中的代码进行分析</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>)</span></code></pre></div>
<p><code>rpois(x, y)</code>表示生成x个服从泊松分布的随机数，均值为y。<code>t.test()</code>表示对这两个样本执行独立样本t检验。
在<code>simplify = FALSE</code>下，<code>sapply()</code>类似于<code>lapply()</code>。</p>
<p>下面使用匿名函数和<code>sapply()</code>提取p值如下：</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(ttest) ttest<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.807919932 0.665511753 0.827771652 0.534899644 0.211737338 0.528643574
##   [7] 0.036299941 0.016286246 0.812200341 0.183029433 0.045674206 0.420195198
##  [13] 0.577173408 0.874254166 0.677908319 0.347553226 0.361554497 0.918737314
##  [19] 0.559098294 0.002509499 0.768217661 0.898061689 0.003256698 1.000000000
##  [25] 0.160902588 0.968015378 0.945869071 0.487230574 0.790842602 0.312865917
##  [31] 0.526127245 0.960313898 0.408238277 0.535864285 0.129220433 0.521667733
##  [37] 0.952101571 0.929053803 0.971746957 0.011601477 0.374260383 0.692475913
##  [43] 0.153917384 0.645121214 0.181853971 0.224322502 0.163462092 1.000000000
##  [49] 0.826032130 0.679110040 0.371457538 0.839837144 0.503046077 0.201307366
##  [55] 0.383173622 0.528297119 0.146797813 0.148537031 0.069654366 0.165229047
##  [61] 0.295638950 0.895620390 0.219622769 0.843794785 0.313497276 0.815388972
##  [67] 0.232485704 0.992897313 0.894949409 0.737031460 0.033341396 0.915558739
##  [73] 0.605572394 0.295777799 0.838840978 0.574006877 0.156308726 0.912461904
##  [79] 0.312905736 0.673237060 0.868453722 0.165275770 0.776816328 0.170876446
##  [85] 0.888611596 0.345857314 0.804162036 0.587077292 0.419642761 0.018360012
##  [91] 0.771416249 0.745960582 0.239627472 0.824506887 0.990644333 0.290741422
##  [97] 0.594800048 0.272107922 0.981034416 0.947306215</code></pre>
</div>
</div>
<div id="exercise-p214_6" class="section level2">
<h2>Exercise p214_6</h2>
<div id="question-28" class="section level3">
<h3>Question</h3>
<ul>
<li>实现<code>Map()</code>和<code>vapply()</code>的组合，以创建一个<code>lapply()</code>变量，该变量对所有输入进行迭代，并将其输出存储在一个向量（矩阵）中。</li>
</ul>
</div>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<p><code>Map()</code>是一个内置函数，用于对一个可迭代对象中的每个元素应用给定的函数，然后返回一个迭代器。
<code>vapply()</code>函数可以确定输出的格式。</p>
<p>使用<code>Map()</code>和<code>vapply()</code>的组合实现数组中元素的平方求解。</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a><span class="co"># 使用 Map() 和 vapply() 实现 lapply() 的功能</span></span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Map</span>(<span class="cf">function</span>(x) <span class="fu">vapply</span>(x, <span class="cf">function</span>(y) y<span class="sc">^</span><span class="dv">2</span>, <span class="fu">numeric</span>(<span class="dv">1</span>)), my_list)</span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>  <span class="at">before =</span> <span class="fu">as.double</span>(<span class="fu">unlist</span>(my_list)),</span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>  <span class="at">after =</span> <span class="fu">as.double</span>(<span class="fu">unlist</span>(result))</span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##   before after
## 1      1     1
## 2      2     4
## 3      3     9
## 4      4    16
## 5      5    25</code></pre>
</div>
</div>
<div id="exercise-p365_4_5" class="section level2">
<h2>Exercise p365_4_5</h2>
<div id="question-29" class="section level3">
<h3>Question</h3>
<ul>
<li>实现一个卡方检验统计量的计算函数，比R语言中的内置函数更好。</li>
<li>优化<code>table()</code>函数，是否能够进一步改进卡方检验统计量的计算。</li>
</ul>
</div>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<p>实现两个没有缺失值的数字向量的卡方检验统计量的计算</p>
<p>计算思路：</p>
<ul>
<li>生成两个没有缺失值的数字向量<span class="math inline">\(x,y\)</span>,并分析它们之间的显著关系。</li>
<li>计算数据框的行列和。</li>
<li>计算对应的期望值。</li>
<li>计算实际观测值与期望值之间的偏差。</li>
</ul>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">12</span>,<span class="dv">18</span>)</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">31</span>,<span class="dv">71</span>,<span class="dv">45</span>)</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(x,y)</span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a><span class="co"># 计算行列和</span></span>
<span id="cb131-5"><a href="#cb131-5" tabindex="-1"></a>datasum <span class="ot">=</span> <span class="fu">sum</span>(data)</span>
<span id="cb131-6"><a href="#cb131-6" tabindex="-1"></a><span class="co"># 按列求和</span></span>
<span id="cb131-7"><a href="#cb131-7" tabindex="-1"></a>sr <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(data)</span>
<span id="cb131-8"><a href="#cb131-8" tabindex="-1"></a><span class="co"># 按行求和</span></span>
<span id="cb131-9"><a href="#cb131-9" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">colSums</span>(data)</span>
<span id="cb131-10"><a href="#cb131-10" tabindex="-1"></a><span class="co"># 计算对应的期望值</span></span>
<span id="cb131-11"><a href="#cb131-11" tabindex="-1"></a>E <span class="ot">=</span> <span class="fu">outer</span>(sc,sr)<span class="sc">/</span>datasum</span>
<span id="cb131-12"><a href="#cb131-12" tabindex="-1"></a><span class="co"># 计算实际观测值与期望值的偏差和</span></span>
<span id="cb131-13"><a href="#cb131-13" tabindex="-1"></a>chisq <span class="ot">=</span> <span class="fu">sum</span>((<span class="fu">t</span>(<span class="fu">as.matrix</span>(data))<span class="sc">-</span>E)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>E)</span>
<span id="cb131-14"><a href="#cb131-14" tabindex="-1"></a>chisq</span></code></pre></div>
<pre><code>## [1] 14.46996</code></pre>
<p>改进<code>table()</code>函数，使用匿名函数和<code>sapply()</code>实现。</p>
<p>改进思路：</p>
<ul>
<li>转换为集合，确定出现过的元素</li>
<li>利用函数<code>sapply()</code>确定元素的数量</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>Fruit <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Orange&quot;</span>,<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>          <span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Orange&quot;</span>, <span class="st">&quot;Apple&quot;</span>)</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>Gender <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>           <span class="st">&quot;Female&quot;</span>,<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Male&quot;</span>)</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a></span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(Gender, Fruit)</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a><span class="co"># 确定出现的元素</span></span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>fruituni <span class="ot">=</span> <span class="fu">unique</span>(Fruit)</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a>genderuni <span class="ot">=</span> <span class="fu">unique</span>(Gender)</span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a><span class="co"># 计算出现的数量</span></span>
<span id="cb133-12"><a href="#cb133-12" tabindex="-1"></a>count_occurrences <span class="ot">&lt;-</span> <span class="cf">function</span>(x, B) {</span>
<span id="cb133-13"><a href="#cb133-13" tabindex="-1"></a>  <span class="fu">sum</span>(x <span class="sc">==</span> B)</span>
<span id="cb133-14"><a href="#cb133-14" tabindex="-1"></a>}</span>
<span id="cb133-15"><a href="#cb133-15" tabindex="-1"></a></span>
<span id="cb133-16"><a href="#cb133-16" tabindex="-1"></a>Fru_counts_male <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fruituni, count_occurrences, <span class="at">B =</span> <span class="fu">subset</span>(data, Gender <span class="sc">==</span> <span class="st">&quot;Male&quot;</span>))</span>
<span id="cb133-17"><a href="#cb133-17" tabindex="-1"></a>Fru_counts_female <span class="ot">&lt;-</span> <span class="fu">sapply</span>(fruituni, count_occurrences, <span class="at">B =</span> <span class="fu">subset</span>(data, Gender <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb133-18"><a href="#cb133-18" tabindex="-1"></a></span>
<span id="cb133-19"><a href="#cb133-19" tabindex="-1"></a><span class="fu">data.frame</span>(Fru_counts_female,Fru_counts_male)</span></code></pre></div>
<pre><code>##        Fru_counts_female Fru_counts_male
## Apple                  5               3
## Banana                 1               2
## Orange                 2               2</code></pre>
</div>
</div>
</div>
<div id="homework9---11-24" class="section level1">
<h1>Homework9 - 11-24</h1>
<div id="exercise-1-1" class="section level2">
<h2>Exercise 1</h2>
<div id="question-30" class="section level3">
<h3>Question</h3>
<ul>
<li>对书本中Exercise9.8中题目使用Rcpp实现</li>
</ul>
</div>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<p>使用Gibbs采样双变量分布</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a><span class="fu">library</span>(SA24204125)</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a></span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a></span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a><span class="co"># 运行 Gibbs 采样</span></span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">gibbsCpp</span>(N, a, b, n, burn)</span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a></span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb135-15"><a href="#cb135-15" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;y&#39;</span>, <span class="at">ylim=</span><span class="fu">range</span>(result[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-234" class="section level2">
<h2>Exercise 2,3,4</h2>
<div id="question-31" class="section level3">
<h3>Question</h3>
<ul>
<li>利用<code>qqplot</code>对比<code>R</code>生成的随机数和<code>cpp</code>生成的随机数</li>
<li>利用<code>microbenchark</code>比较两种程序的运行时间</li>
<li>比较运行的结果</li>
</ul>
</div>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<p>在R中运行如下：</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>gibbs_R <span class="ot">=</span> <span class="cf">function</span>(N,a,b,n,burn){</span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>  <span class="co"># 链的初始值</span></span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="fl">0.5</span>)  <span class="co"># 随机初始化 x</span></span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a>  y0 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,a,b)  <span class="co"># 随机初始化 y</span></span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0, y0)</span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a>  </span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a>  <span class="co"># 进行Gibbs采样</span></span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a>    y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a>  }</span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a>  </span>
<span id="cb136-23"><a href="#cb136-23" tabindex="-1"></a>  <span class="co"># 丢弃前1000个数据</span></span>
<span id="cb136-24"><a href="#cb136-24" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb136-25"><a href="#cb136-25" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb136-26"><a href="#cb136-26" tabindex="-1"></a>}</span>
<span id="cb136-27"><a href="#cb136-27" tabindex="-1"></a></span>
<span id="cb136-28"><a href="#cb136-28" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">gibbs_R</span>(N,a,b,n,burn)</span>
<span id="cb136-29"><a href="#cb136-29" tabindex="-1"></a><span class="co"># 可视化Gibbs采样</span></span>
<span id="cb136-30"><a href="#cb136-30" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="st">&#39;x&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;y&#39;</span>, <span class="at">ylim=</span><span class="fu">range</span>(X[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>比较两种方法生成的QQ图</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">1</span>], result[,<span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot of X&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;X from R&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;X from Cpp&quot;</span>)</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># 添加 y = x 的参考线</span></span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">2</span>], result[,<span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot of Y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Y from R&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y from Cpp&quot;</span>)</span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># 添加 y = x 的参考线</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以发现用两种方法生成的数据的分布是一样的。</p>
<p>下面，比较两种方法的运行时间：</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a><span class="fu">library</span>(SA24204125)</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">Rgibbs =</span> <span class="fu">gibbs_R</span>(N,a,b,n,burn), <span class="at">Cppgibbs =</span> <span class="fu">gibbsCpp</span>(N, a, b, n, burn))</span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##       expr       lq   median       uq
## 1   Rgibbs 33.17975 37.45865 48.17445
## 2 Cppgibbs  4.60745  5.19175  7.07745</code></pre>
<p>对比结果可以发现，<code>Rcpp</code>的运行速度显著高于在<code>R</code>本身中运行。</p>
<p>通过以上对比以及可视化结果可以发现，从结果的准确度来看，两种方式都可以生成准确的数据，但是使用Rcpp运行可以显著提高运行速度。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
